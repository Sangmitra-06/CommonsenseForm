{"ast":null,"code":"export const loadQuestionsData = async () => {\n  try {\n    console.log('Loading questions from public/questions.json...');\n    const response = await fetch('/questions.json');\n    if (!response.ok) {\n      throw new Error(`Failed to load questions: ${response.status} ${response.statusText}`);\n    }\n    const data = await response.json();\n\n    // Validate the data structure\n    if (!Array.isArray(data) || data.length === 0) {\n      throw new Error('Questions data is not in the expected format');\n    }\n\n    // Calculate totals for logging\n    const totalQuestions = data.reduce((sum, cat) => sum + cat.subcategories.reduce((subSum, sub) => subSum + sub.topics.reduce((topicSum, topic) => topicSum + topic.questions.length, 0), 0), 0);\n    console.log('Questions loaded successfully:', {\n      categories: data.length,\n      totalSubcategories: data.reduce((sum, cat) => sum + cat.subcategories.length, 0),\n      totalTopics: data.reduce((sum, cat) => sum + cat.subcategories.reduce((subSum, sub) => subSum + sub.topics.length, 0), 0),\n      totalQuestions\n    });\n    return data;\n  } catch (error) {\n    console.error('Error loading questions data:', error);\n    throw new Error('Failed to load questions data');\n  }\n};\nexport const validateAnswer = answer => {\n  if (!answer || answer.trim().length === 0) {\n    return {\n      isValid: false,\n      message: 'Please provide an answer or specify \"none\" if no answer exists'\n    };\n  }\n  if (answer.trim().length < 4) {\n    return {\n      isValid: false,\n      message: 'Please provide a more detailed answer (at least 4 characters) or specify \"none\"'\n    };\n  }\n  if (answer.length > 5000) {\n    return {\n      isValid: false,\n      message: 'Answer is too long (maximum 5000 characters)'\n    };\n  }\n  return {\n    isValid: true\n  };\n};\nexport const shouldShowAttentionCheck = questionCount => {\n  console.log('Checking if should show attention check:', {\n    questionCount,\n    isDivisibleBy7: questionCount > 0 && questionCount % 7 === 0,\n    result: questionCount > 0 && questionCount % 7 === 0\n  });\n  return questionCount > 0 && questionCount % 7 === 0;\n};\n\n// NEW: Improved attention check validation\nexport const validateAttentionCheck = (userAnswer, expectedAnswers) => {\n  if (!userAnswer || typeof userAnswer !== 'string') {\n    console.log('Attention check failed: Empty or invalid answer');\n    return false;\n  }\n\n  // Clean and normalize the user's answer\n  const cleanAnswer = userAnswer.toLowerCase().trim().replace(/[^\\w\\s]/g, '') // Remove punctuation\n  .replace(/\\s+/g, ' '); // Normalize whitespace\n\n  console.log('Validating attention check:', {\n    originalAnswer: userAnswer,\n    cleanAnswer: cleanAnswer,\n    expectedAnswers: expectedAnswers\n  });\n\n  // Check against all accepted answers\n  const isValid = expectedAnswers.some(acceptedAnswer => {\n    const cleanAccepted = acceptedAnswer.toLowerCase().trim();\n\n    // Exact match\n    if (cleanAnswer === cleanAccepted) {\n      console.log('Attention check passed: Exact match');\n      return true;\n    }\n\n    // Check if the answer contains the expected word (for cases like \"the sun is yellow\")\n    if (cleanAnswer.includes(cleanAccepted)) {\n      console.log('Attention check passed: Contains expected answer');\n      return true;\n    }\n\n    // Check for common variations\n    if (cleanAccepted === 'yellow' && (cleanAnswer.includes('gold') || cleanAnswer === 'golden')) {\n      console.log('Attention check passed: Yellow variation');\n      return true;\n    }\n    if (cleanAccepted === 'tuesday' && cleanAnswer === 'tue') {\n      console.log('Attention check passed: Tuesday abbreviation');\n      return true;\n    }\n    return false;\n  });\n  console.log('Attention check result:', isValid);\n  return isValid;\n};\n\n// Comprehensive quality analysis\n// Fixed version for helpers.ts\nexport const analyzeResponseQuality = answer => {\n  const issues = [];\n  let score = 100;\n  let isNoneResponse = false;\n  let isGibberish = false;\n  const text = answer.toLowerCase().trim();\n\n  // More lenient \"none\" patterns - only flag obviously lazy responses\n  const nonePatterns = [/^(none|n\\/a|na|nothing|no|idk|dk)$/i, /^(same|normal|usual|regular|typical)$/i];\n\n  // More specific legitimate none responses (don't penalize these)\n  const legitimateNonePatterns = [/^(none that i know|nothing that i know|not in my region|not applicable here)/i, /^(we don't have|not common here|not practiced in)/i];\n\n  // Check for none responses - but be more lenient\n  const hasNoneResponse = nonePatterns.some(pattern => pattern.test(text)) && !legitimateNonePatterns.some(pattern => pattern.test(text));\n  if (hasNoneResponse && text.length < 8) {\n    // Only flag very short \"none\" responses\n    isNoneResponse = true;\n    issues.push('Very brief response - consider adding more detail if possible');\n    score -= 25; // Reduced penalty\n  }\n\n  // More strict gibberish detection\n  const gibberishPatterns = [/^[bcdfghjklmnpqrstvwxyz]{8,}$/i,\n  // Increased threshold\n  /^[aeiou]{8,}$/i, /(.{4,})\\1{3,}/,\n  // Repeated patterns (more strict)\n  /^[^a-z\\s]*$/i // No letters at all\n  ];\n\n  // Keyboard mashing patterns\n  const mashingPatterns = [/qwerty|asdf|zxcv|hjkl|yuiop/i, /abcd|1234|test|xxx|yyy|zzz/i, /(.)\\1{6,}/ // Same character repeated 6+ times (increased)\n  ];\n\n  // Check for gibberish\n  const hasGibberish = gibberishPatterns.some(pattern => pattern.test(text));\n  if (hasGibberish) {\n    isGibberish = true;\n    issues.push('Appears to be random characters');\n    score -= 70;\n  }\n\n  // Check for keyboard mashing\n  const hasMashing = mashingPatterns.some(pattern => pattern.test(text));\n  if (hasMashing && !hasGibberish) {\n    isGibberish = true;\n    issues.push('Keyboard mashing detected');\n    score -= 60;\n  }\n\n  // Only flag as low quality if score is very low\n  score = Math.max(0, Math.min(100, score));\n  return {\n    isLowQuality: score < 20,\n    // Increased threshold\n    issues,\n    score,\n    isNoneResponse,\n    isGibberish\n  };\n};\nexport const analyzeUserPattern = responses => {\n  const warnings = [];\n  let suspiciousPattern = false;\n  if (responses.length < 8) {\n    // Increased minimum threshold\n    return {\n      suspiciousPattern: false,\n      // Don't flag with too few responses\n      warnings,\n      noneResponseRate: 0,\n      gibberishResponseRate: 0,\n      fastResponseRate: 0,\n      issueType: null\n    };\n  }\n\n  // Rest of the function stays the same but with higher thresholds\n  let noneCount = 0;\n  let gibberishCount = 0;\n  let fastResponseCount = 0;\n  responses.forEach(response => {\n    const analysis = analyzeResponseQuality(response.answer);\n    if (analysis.isNoneResponse) noneCount++;\n    if (analysis.isGibberish) gibberishCount++;\n    if (response.timeSpent < 3) fastResponseCount++; // Reduced threshold\n  });\n  const noneResponseRate = noneCount / responses.length * 100;\n  const gibberishResponseRate = gibberishCount / responses.length * 100;\n  const fastResponseRate = fastResponseCount / responses.length * 100;\n  let primaryIssue = null;\n\n  // Higher thresholds for flagging patterns\n  if (noneResponseRate >= 50) {\n    // Increased from 30%\n    warnings.push(`High rate of \"none\" responses (${noneResponseRate.toFixed(1)}%)`);\n    suspiciousPattern = true;\n    primaryIssue = 'none';\n  }\n  if (gibberishResponseRate >= 40) {\n    // Increased from 30%\n    warnings.push(`High rate of gibberish responses (${gibberishResponseRate.toFixed(1)}%)`);\n    suspiciousPattern = true;\n    if (!primaryIssue) primaryIssue = 'gibberish';\n  }\n  if (fastResponseRate >= 60) {\n    // Increased from 30%\n    warnings.push(`High rate of very quick responses (${fastResponseRate.toFixed(1)}%)`);\n    suspiciousPattern = true;\n    if (!primaryIssue) primaryIssue = 'speed';\n  }\n  return {\n    suspiciousPattern,\n    warnings,\n    noneResponseRate,\n    gibberishResponseRate,\n    fastResponseRate,\n    issueType: primaryIssue\n  };\n};\n// NEW: Enhanced attention check generation with multiple correct answers\n// Simpler version - track used checks in component state only\nexport const generateAttentionCheck = (currentCategory, currentTopic, checkNumber = 1, userInfo) => {\n  // Define the two checks\n  const countryCheck = {\n    question: 'This survey is about cultural practices in which country? Please type the country name.',\n    correctAnswers: ['india', 'bharat'],\n    type: 'country'\n  };\n  const regionCheck = {\n    question: `What region of India did you specify at the beginning of this survey? Please write the name of the region (North, South, East, West, or Central).`,\n    correctAnswers: userInfo ? [userInfo.region.toLowerCase()] : ['north', 'south', 'east', 'west', 'central'],\n    type: 'region'\n  };\n\n  // Always show country first, region second for consistency\n  const selectedCheck = checkNumber === 1 ? countryCheck : regionCheck;\n  console.log('Generated attention check:', {\n    checkNumber,\n    type: selectedCheck.type,\n    userRegion: userInfo === null || userInfo === void 0 ? void 0 : userInfo.region\n  });\n  return {\n    question: selectedCheck.question,\n    options: [],\n    correctAnswer: 0,\n    expectedAnswer: selectedCheck.correctAnswers[0],\n    expectedAnswers: selectedCheck.correctAnswers,\n    currentTopic,\n    currentCategory,\n    type: selectedCheck.type\n  };\n};\n\n// Utility functions\nexport const generateQuestionId = (categoryIndex, subcategoryIndex, topicIndex, questionIndex) => {\n  return `${categoryIndex}-${subcategoryIndex}-${topicIndex}-${questionIndex}`;\n};\nexport const formatTime = seconds => {\n  const mins = Math.floor(seconds / 60);\n  const secs = seconds % 60;\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\n};\nexport const debounce = (func, wait) => {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func.apply(null, args), wait);\n  };\n};\nexport const getEstimatedTimeRemaining = (totalQuestions, completedQuestions, averageTimePerQuestion = 120) => {\n  const remainingQuestions = totalQuestions - completedQuestions;\n  const estimatedSeconds = remainingQuestions * averageTimePerQuestion;\n  if (estimatedSeconds < 3600) {\n    const minutes = Math.ceil(estimatedSeconds / 60);\n    return `~${minutes} minute${minutes !== 1 ? 's' : ''} remaining`;\n  } else {\n    const hours = Math.ceil(estimatedSeconds / 3600);\n    return `~${hours} hour${hours !== 1 ? 's' : ''} remaining`;\n  }\n};","map":{"version":3,"names":["loadQuestionsData","console","log","response","fetch","ok","Error","status","statusText","data","json","Array","isArray","length","totalQuestions","reduce","sum","cat","subcategories","subSum","sub","topics","topicSum","topic","questions","categories","totalSubcategories","totalTopics","error","validateAnswer","answer","trim","isValid","message","shouldShowAttentionCheck","questionCount","isDivisibleBy7","result","validateAttentionCheck","userAnswer","expectedAnswers","cleanAnswer","toLowerCase","replace","originalAnswer","some","acceptedAnswer","cleanAccepted","includes","analyzeResponseQuality","issues","score","isNoneResponse","isGibberish","text","nonePatterns","legitimateNonePatterns","hasNoneResponse","pattern","test","push","gibberishPatterns","mashingPatterns","hasGibberish","hasMashing","Math","max","min","isLowQuality","analyzeUserPattern","responses","warnings","suspiciousPattern","noneResponseRate","gibberishResponseRate","fastResponseRate","issueType","noneCount","gibberishCount","fastResponseCount","forEach","analysis","timeSpent","primaryIssue","toFixed","generateAttentionCheck","currentCategory","currentTopic","checkNumber","userInfo","countryCheck","question","correctAnswers","type","regionCheck","region","selectedCheck","userRegion","options","correctAnswer","expectedAnswer","generateQuestionId","categoryIndex","subcategoryIndex","topicIndex","questionIndex","formatTime","seconds","mins","floor","secs","toString","padStart","debounce","func","wait","timeout","args","clearTimeout","setTimeout","apply","getEstimatedTimeRemaining","completedQuestions","averageTimePerQuestion","remainingQuestions","estimatedSeconds","minutes","ceil","hours"],"sources":["C:/Users/sangm/OneDrive - Brock University/CommonsenseForm/client/src/utils/helpers.ts"],"sourcesContent":["import { Category, AttentionCheck } from '../types/index.ts';\r\n\r\nexport const loadQuestionsData = async (): Promise<Category[]> => {\r\n  try {\r\n    console.log('Loading questions from public/questions.json...');\r\n    \r\n    const response = await fetch('/questions.json');\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`Failed to load questions: ${response.status} ${response.statusText}`);\r\n    }\r\n    \r\n    const data: Category[] = await response.json();\r\n    \r\n    // Validate the data structure\r\n    if (!Array.isArray(data) || data.length === 0) {\r\n      throw new Error('Questions data is not in the expected format');\r\n    }\r\n    \r\n    // Calculate totals for logging\r\n    const totalQuestions = data.reduce((sum, cat) => \r\n      sum + cat.subcategories.reduce((subSum, sub) => \r\n        subSum + sub.topics.reduce((topicSum, topic) => topicSum + topic.questions.length, 0), 0), 0);\r\n    \r\n    console.log('Questions loaded successfully:', {\r\n      categories: data.length,\r\n      totalSubcategories: data.reduce((sum, cat) => sum + cat.subcategories.length, 0),\r\n      totalTopics: data.reduce((sum, cat) => \r\n        sum + cat.subcategories.reduce((subSum, sub) => subSum + sub.topics.length, 0), 0),\r\n      totalQuestions\r\n    });\r\n    \r\n    return data;\r\n    \r\n  } catch (error) {\r\n    console.error('Error loading questions data:', error);\r\n    throw new Error('Failed to load questions data');\r\n  }\r\n};\r\n\r\nexport const validateAnswer = (answer: string): { isValid: boolean; message?: string } => {\r\n  if (!answer || answer.trim().length === 0) {\r\n    return { isValid: false, message: 'Please provide an answer or specify \"none\" if no answer exists' };\r\n  }\r\n  \r\n  if (answer.trim().length < 4) {\r\n    return { isValid: false, message: 'Please provide a more detailed answer (at least 4 characters) or specify \"none\"' };\r\n  }\r\n  \r\n  if (answer.length > 5000) {\r\n    return { isValid: false, message: 'Answer is too long (maximum 5000 characters)' };\r\n  }\r\n  \r\n  return { isValid: true };\r\n};\r\n\r\nexport const shouldShowAttentionCheck = (questionCount: number): boolean => {\r\n  console.log('Checking if should show attention check:', {\r\n    questionCount,\r\n    isDivisibleBy7: questionCount > 0 && questionCount % 7 === 0,\r\n    result: questionCount > 0 && questionCount % 7 === 0\r\n  });\r\n  \r\n  return questionCount > 0 && questionCount % 7 === 0;\r\n};\r\n\r\n// NEW: Improved attention check validation\r\nexport const validateAttentionCheck = (userAnswer: string, expectedAnswers: string[]): boolean => {\r\n  if (!userAnswer || typeof userAnswer !== 'string') {\r\n    console.log('Attention check failed: Empty or invalid answer');\r\n    return false;\r\n  }\r\n\r\n  // Clean and normalize the user's answer\r\n  const cleanAnswer = userAnswer\r\n    .toLowerCase()\r\n    .trim()\r\n    .replace(/[^\\w\\s]/g, '') // Remove punctuation\r\n    .replace(/\\s+/g, ' '); // Normalize whitespace\r\n\r\n  console.log('Validating attention check:', {\r\n    originalAnswer: userAnswer,\r\n    cleanAnswer: cleanAnswer,\r\n    expectedAnswers: expectedAnswers\r\n  });\r\n\r\n  // Check against all accepted answers\r\n  const isValid = expectedAnswers.some(acceptedAnswer => {\r\n    const cleanAccepted = acceptedAnswer.toLowerCase().trim();\r\n    \r\n    // Exact match\r\n    if (cleanAnswer === cleanAccepted) {\r\n      console.log('Attention check passed: Exact match');\r\n      return true;\r\n    }\r\n    \r\n    // Check if the answer contains the expected word (for cases like \"the sun is yellow\")\r\n    if (cleanAnswer.includes(cleanAccepted)) {\r\n      console.log('Attention check passed: Contains expected answer');\r\n      return true;\r\n    }\r\n    \r\n    // Check for common variations\r\n    if (cleanAccepted === 'yellow' && (cleanAnswer.includes('gold') || cleanAnswer === 'golden')) {\r\n      console.log('Attention check passed: Yellow variation');\r\n      return true;\r\n    }\r\n    \r\n    if (cleanAccepted === 'tuesday' && cleanAnswer === 'tue') {\r\n      console.log('Attention check passed: Tuesday abbreviation');\r\n      return true;\r\n    }\r\n    \r\n    return false;\r\n  });\r\n\r\n  console.log('Attention check result:', isValid);\r\n  return isValid;\r\n};\r\n\r\n// Comprehensive quality analysis\r\n// Fixed version for helpers.ts\r\nexport const analyzeResponseQuality = (answer: string): {\r\n  isLowQuality: boolean;\r\n  issues: string[];\r\n  score: number;\r\n  isNoneResponse: boolean;\r\n  isGibberish: boolean;\r\n} => {\r\n  const issues: string[] = [];\r\n  let score = 100;\r\n  let isNoneResponse = false;\r\n  let isGibberish = false;\r\n\r\n  const text = answer.toLowerCase().trim();\r\n  \r\n  // More lenient \"none\" patterns - only flag obviously lazy responses\r\n  const nonePatterns = [\r\n    /^(none|n\\/a|na|nothing|no|idk|dk)$/i,\r\n    /^(same|normal|usual|regular|typical)$/i,\r\n  ];\r\n\r\n  // More specific legitimate none responses (don't penalize these)\r\n  const legitimateNonePatterns = [\r\n    /^(none that i know|nothing that i know|not in my region|not applicable here)/i,\r\n    /^(we don't have|not common here|not practiced in)/i,\r\n  ];\r\n\r\n  // Check for none responses - but be more lenient\r\n  const hasNoneResponse = nonePatterns.some(pattern => pattern.test(text)) && \r\n                         !legitimateNonePatterns.some(pattern => pattern.test(text));\r\n  \r\n  if (hasNoneResponse && text.length < 8) { // Only flag very short \"none\" responses\r\n    isNoneResponse = true;\r\n    issues.push('Very brief response - consider adding more detail if possible');\r\n    score -= 25; // Reduced penalty\r\n  }\r\n\r\n  // More strict gibberish detection\r\n  const gibberishPatterns = [\r\n    /^[bcdfghjklmnpqrstvwxyz]{8,}$/i, // Increased threshold\r\n    /^[aeiou]{8,}$/i,\r\n    /(.{4,})\\1{3,}/, // Repeated patterns (more strict)\r\n    /^[^a-z\\s]*$/i, // No letters at all\r\n  ];\r\n\r\n  // Keyboard mashing patterns\r\n  const mashingPatterns = [\r\n    /qwerty|asdf|zxcv|hjkl|yuiop/i,\r\n    /abcd|1234|test|xxx|yyy|zzz/i,\r\n    /(.)\\1{6,}/, // Same character repeated 6+ times (increased)\r\n  ];\r\n\r\n  // Check for gibberish\r\n  const hasGibberish = gibberishPatterns.some(pattern => pattern.test(text));\r\n  if (hasGibberish) {\r\n    isGibberish = true;\r\n    issues.push('Appears to be random characters');\r\n    score -= 70;\r\n  }\r\n\r\n  // Check for keyboard mashing\r\n  const hasMashing = mashingPatterns.some(pattern => pattern.test(text));\r\n  if (hasMashing && !hasGibberish) {\r\n    isGibberish = true;\r\n    issues.push('Keyboard mashing detected');\r\n    score -= 60;\r\n  }\r\n\r\n  // Only flag as low quality if score is very low\r\n  score = Math.max(0, Math.min(100, score));\r\n  \r\n  return {\r\n    isLowQuality: score < 20, // Increased threshold\r\n    issues,\r\n    score,\r\n    isNoneResponse,\r\n    isGibberish\r\n  };\r\n};\r\n\r\nexport const analyzeUserPattern = (responses: Array<{answer: string, timeSpent: number}>): {\r\n  suspiciousPattern: boolean;\r\n  warnings: string[];\r\n  noneResponseRate: number;\r\n  gibberishResponseRate: number;\r\n  fastResponseRate: number;\r\n  issueType: string | null;\r\n} => {\r\n  const warnings: string[] = [];\r\n  let suspiciousPattern = false;\r\n\r\n  if (responses.length < 8) { // Increased minimum threshold\r\n    return { \r\n      suspiciousPattern: false, // Don't flag with too few responses\r\n      warnings, \r\n      noneResponseRate: 0,\r\n      gibberishResponseRate: 0,\r\n      fastResponseRate: 0,\r\n      issueType: null\r\n    };\r\n  }\r\n\r\n  // Rest of the function stays the same but with higher thresholds\r\n  let noneCount = 0;\r\n  let gibberishCount = 0;\r\n  let fastResponseCount = 0;\r\n\r\n  responses.forEach(response => {\r\n    const analysis = analyzeResponseQuality(response.answer);\r\n    \r\n    if (analysis.isNoneResponse) noneCount++;\r\n    if (analysis.isGibberish) gibberishCount++;\r\n    if (response.timeSpent < 3) fastResponseCount++; // Reduced threshold\r\n  });\r\n\r\n  const noneResponseRate = (noneCount / responses.length) * 100;\r\n  const gibberishResponseRate = (gibberishCount / responses.length) * 100;\r\n  const fastResponseRate = (fastResponseCount / responses.length) * 100;\r\n\r\n  let primaryIssue: string | null = null;\r\n\r\n  // Higher thresholds for flagging patterns\r\n  if (noneResponseRate >= 50) { // Increased from 30%\r\n    warnings.push(`High rate of \"none\" responses (${noneResponseRate.toFixed(1)}%)`);\r\n    suspiciousPattern = true;\r\n    primaryIssue = 'none';\r\n  }\r\n\r\n  if (gibberishResponseRate >= 40) { // Increased from 30%\r\n    warnings.push(`High rate of gibberish responses (${gibberishResponseRate.toFixed(1)}%)`);\r\n    suspiciousPattern = true;\r\n    if (!primaryIssue) primaryIssue = 'gibberish';\r\n  }\r\n\r\n  if (fastResponseRate >= 60) { // Increased from 30%\r\n    warnings.push(`High rate of very quick responses (${fastResponseRate.toFixed(1)}%)`);\r\n    suspiciousPattern = true;\r\n    if (!primaryIssue) primaryIssue = 'speed';\r\n  }\r\n\r\n  return { \r\n    suspiciousPattern, \r\n    warnings, \r\n    noneResponseRate,\r\n    gibberishResponseRate,\r\n    fastResponseRate,\r\n    issueType: primaryIssue\r\n  };\r\n};\r\n// NEW: Enhanced attention check generation with multiple correct answers\r\n// Simpler version - track used checks in component state only\r\nexport const generateAttentionCheck = (\r\n  currentCategory: string,\r\n  currentTopic: string,\r\n  checkNumber: number = 1, // 1 for first check, 2 for second check\r\n  userInfo?: { region: string; age: number }\r\n): AttentionCheck => {\r\n  \r\n  // Define the two checks\r\n  const countryCheck = {\r\n    question: 'This survey is about cultural practices in which country? Please type the country name.',\r\n    correctAnswers: ['india', 'bharat'],\r\n    type: 'country'\r\n  };\r\n  \r\n  const regionCheck = {\r\n    question: `What region of India did you specify at the beginning of this survey? Please write the name of the region (North, South, East, West, or Central).`,\r\n    correctAnswers: userInfo ? [userInfo.region.toLowerCase()] : ['north', 'south', 'east', 'west', 'central'],\r\n    type: 'region'\r\n  };\r\n\r\n  // Always show country first, region second for consistency\r\n  const selectedCheck = checkNumber === 1 ? countryCheck : regionCheck;\r\n  \r\n  console.log('Generated attention check:', {\r\n    checkNumber,\r\n    type: selectedCheck.type,\r\n    userRegion: userInfo?.region\r\n  });\r\n\r\n  return {\r\n    question: selectedCheck.question,\r\n    options: [],\r\n    correctAnswer: 0,\r\n    expectedAnswer: selectedCheck.correctAnswers[0],\r\n    expectedAnswers: selectedCheck.correctAnswers,\r\n    currentTopic,\r\n    currentCategory,\r\n    type: selectedCheck.type\r\n  };\r\n};\r\n\r\n\r\n\r\n// Utility functions\r\nexport const generateQuestionId = (\r\n  categoryIndex: number,\r\n  subcategoryIndex: number,\r\n  topicIndex: number,\r\n  questionIndex: number\r\n): string => {\r\n  return `${categoryIndex}-${subcategoryIndex}-${topicIndex}-${questionIndex}`;\r\n};\r\n\r\nexport const formatTime = (seconds: number): string => {\r\n  const mins = Math.floor(seconds / 60);\r\n  const secs = seconds % 60;\r\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n};\r\n\r\nexport const debounce = <T extends (...args: any[]) => any>(\r\n  func: T,\r\n  wait: number\r\n): ((...args: Parameters<T>) => void) => {\r\n  let timeout: ReturnType<typeof setTimeout>;\r\n  \r\n  return (...args: Parameters<T>) => {\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(() => func.apply(null, args), wait);\r\n  };\r\n};\r\n\r\nexport const getEstimatedTimeRemaining = (\r\n  totalQuestions: number,\r\n  completedQuestions: number,\r\n  averageTimePerQuestion: number = 120\r\n): string => {\r\n  const remainingQuestions = totalQuestions - completedQuestions;\r\n  const estimatedSeconds = remainingQuestions * averageTimePerQuestion;\r\n  \r\n  if (estimatedSeconds < 3600) {\r\n    const minutes = Math.ceil(estimatedSeconds / 60);\r\n    return `~${minutes} minute${minutes !== 1 ? 's' : ''} remaining`;\r\n  } else {\r\n    const hours = Math.ceil(estimatedSeconds / 3600);\r\n    return `~${hours} hour${hours !== 1 ? 's' : ''} remaining`;\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}