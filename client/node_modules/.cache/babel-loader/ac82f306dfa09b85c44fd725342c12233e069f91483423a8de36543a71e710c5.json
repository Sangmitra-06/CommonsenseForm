{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sangm\\\\OneDrive - Brock University\\\\CommonsenseForm\\\\client\\\\src\\\\components\\\\QuestionForm.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useForm } from '../context/FormContext.tsx';\nimport { validateAnswer, analyzeResponseQuality, analyzeUserPattern } from '../utils/helpers.ts';\nimport AttentionCheck from './AttentionCheck.tsx';\nimport ProgressBar from './ProgressBar.tsx';\nimport NavigationMenu from './NavigationMenu.tsx';\nimport QualityWarningModal from './QualityWarningModel.tsx';\nimport { updateUserProgress } from '../services/api.ts';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function QuestionForm() {\n  _s();\n  const {\n    state,\n    saveResponse,\n    navigateToNext,\n    navigateToPrevious,\n    getCurrentQuestionData,\n    getTotalQuestionsInCurrentTopic,\n    getCompletedQuestionsInCurrentTopic,\n    resetSession,\n    navigateToPosition\n  } = useForm();\n  const [answer, setAnswer] = useState('');\n  const [culturalCommonsense, setCulturalCommonsense] = useState(null);\n  const [errors, setErrors] = useState({});\n  const [isSaving, setIsSaving] = useState(false);\n  const [showAttentionCheck, setShowAttentionCheck] = useState(false);\n  const [attentionCheck, setAttentionCheck] = useState(null);\n  const [startTime, setStartTime] = useState(Date.now());\n  const [showSuccess, setShowSuccess] = useState(false);\n  const [lastQuestionId, setLastQuestionId] = useState(null);\n  const [isNavigating, setIsNavigating] = useState(false);\n  const [navigationDirection, setNavigationDirection] = useState(null);\n  const [showCelebration, setShowCelebration] = useState(null);\n  const [completedTopicName, setCompletedTopicName] = useState('');\n  const [showNavigationMenu, setShowNavigationMenu] = useState(false);\n  const [lastAttentionCheckAt, setLastAttentionCheckAt] = useState(0); // Track when we last showed attention check\n\n  // Quality tracking states\n  const [qualityWarnings, setQualityWarnings] = useState([]);\n  const [showQualityModal, setShowQualityModal] = useState(false);\n  const [lowQualityCount, setLowQualityCount] = useState(0);\n  const [userPattern, setUserPattern] = useState({\n    suspiciousPattern: false,\n    warnings: []\n  });\n\n  // Add these new state variables in the component\n  const [qualityAlertCount, setQualityAlertCount] = useState(0);\n  const [lastQualityAlertAt, setLastQualityAlertAt] = useState(0);\n  const [attentionChecksPassed, setAttentionChecksPassed] = useState(0);\n  const [attentionChecksFailed, setAttentionChecksFailed] = useState(0);\n  const textareaRef = useRef(null);\n  const currentQuestionData = getCurrentQuestionData();\n\n  // Debug logging\n  console.log('QuestionForm render:', {\n    currentQuestionData: currentQuestionData === null || currentQuestionData === void 0 ? void 0 : currentQuestionData.questionId,\n    answer: answer.substring(0, 20) + (answer.length > 20 ? '...' : ''),\n    culturalCommonsense,\n    showAttentionCheck,\n    responsesCount: state.responses.size,\n    lastAttentionCheckAt\n  });\n\n  // Reset form when question changes\n  useEffect(() => {\n    if (currentQuestionData && currentQuestionData.questionId !== lastQuestionId) {\n      console.log('Question changed, loading data for:', currentQuestionData.questionId);\n\n      // Reset form state\n      setErrors({});\n      setShowSuccess(false);\n      setStartTime(Date.now());\n      setLastQuestionId(currentQuestionData.questionId);\n      setIsNavigating(false);\n      setNavigationDirection(null);\n      setQualityWarnings([]);\n\n      // Load existing response or reset\n      const existingResponse = state.responses.get(currentQuestionData.questionId);\n      if (existingResponse) {\n        console.log('Found existing response:', existingResponse);\n        setAnswer(existingResponse.answer);\n        setCulturalCommonsense(existingResponse.culturalCommonsense);\n      } else {\n        console.log('No existing response, clearing form');\n        setAnswer('');\n        setCulturalCommonsense(null);\n      }\n    }\n  }, [currentQuestionData === null || currentQuestionData === void 0 ? void 0 : currentQuestionData.questionId, lastQuestionId, state.responses]);\n\n  // Calculate low quality count from existing responses\n  useEffect(() => {\n    const responses = Array.from(state.responses.values());\n    const lowQualityResponses = responses.filter(response => {\n      const analysis = analyzeResponseQuality(response.answer);\n      return analysis.score < 40;\n    });\n    setLowQualityCount(lowQualityResponses.length);\n  }, [state.responses]);\n  useEffect(() => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto';\n      textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\n    }\n  }, [answer]);\n\n  // Update the quality tracking with immediate alerts and none-response focus\n  useEffect(() => {\n    if (state.responses.size < 5) return; // Need at least 5 responses to analyze pattern\n\n    const responses = Array.from(state.responses.values());\n    const userPatternAnalysis = analyzeUserPattern(responses.map(r => ({\n      answer: r.answer,\n      timeSpent: r.timeSpent\n    })));\n    setUserPattern(userPatternAnalysis);\n\n    // Show immediate quality alert if \"none\" pattern is problematic\n    if (userPatternAnalysis.nonePattern.isProblematic && lastQualityAlertAt !== state.responses.size) {\n      console.log('QUALITY ALERT: None response pattern detected', userPatternAnalysis.nonePattern);\n      setShowQualityModal(true);\n      setLastQualityAlertAt(state.responses.size);\n      setQualityAlertCount(prev => prev + 1);\n    }\n\n    // If user ignored quality warning for 3+ questions, show again\n    if (qualityAlertCount > 0 && state.responses.size - lastQualityAlertAt >= 3 && userPatternAnalysis.suspiciousPattern) {\n      console.log('PERSISTENT QUALITY ISSUES: Showing alert again after 3 questions');\n      setShowQualityModal(true);\n      setLastQualityAlertAt(state.responses.size);\n      setQualityAlertCount(prev => prev + 1);\n    }\n  }, [state.responses.size, lastQualityAlertAt, qualityAlertCount]);\n  const validateForm = () => {\n    const newErrors = {};\n    const answerValidation = validateAnswer(answer);\n    if (!answerValidation.isValid) {\n      newErrors.answer = answerValidation.message;\n    }\n    if (culturalCommonsense === null) {\n      newErrors.cultural = 'Please select whether this pertains to cultural commonsense';\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n  const handleAnswerChange = e => {\n    const newValue = e.target.value;\n    setAnswer(newValue);\n    if (errors.answer) {\n      setErrors(prev => ({\n        ...prev,\n        answer: undefined\n      }));\n    }\n\n    // Real-time quality analysis\n    if (newValue.length > 5) {\n      const qualityAnalysis = analyzeResponseQuality(newValue);\n      if (qualityAnalysis.isLowQuality) {\n        setQualityWarnings(qualityAnalysis.issues);\n      } else {\n        setQualityWarnings([]);\n      }\n    } else {\n      setQualityWarnings([]);\n    }\n  };\n  const handleCulturalChange = value => {\n    setCulturalCommonsense(value);\n    if (errors.cultural) {\n      setErrors(prev => ({\n        ...prev,\n        cultural: undefined\n      }));\n    }\n  };\n  const handleClear = () => {\n    setAnswer('');\n    setCulturalCommonsense(null);\n    setErrors({});\n    setShowSuccess(false);\n    setQualityWarnings([]);\n    if (textareaRef.current) {\n      textareaRef.current.focus();\n    }\n  };\n  const checkForMilestones = () => {\n    const {\n      categoryIndex,\n      subcategoryIndex,\n      topicIndex,\n      questionIndex\n    } = state.currentPosition;\n    const currentCategory = state.questionsData[categoryIndex];\n    const currentSubcategory = currentCategory === null || currentCategory === void 0 ? void 0 : currentCategory.subcategories[subcategoryIndex];\n    const currentTopic = currentSubcategory === null || currentSubcategory === void 0 ? void 0 : currentSubcategory.topics[topicIndex];\n    if (!currentTopic) return null;\n\n    // Store the current topic name for celebration\n    setCompletedTopicName(currentTopic.topic);\n\n    // Check if this is the last question in the topic\n    if (questionIndex === currentTopic.questions.length - 1) {\n      // Check if this is also the last topic in subcategory\n      if (topicIndex === currentSubcategory.topics.length - 1) {\n        // Check if this is also the last subcategory in category\n        if (subcategoryIndex === currentCategory.subcategories.length - 1) {\n          return {\n            type: 'category',\n            name: currentCategory.category,\n            subcategoryName: currentSubcategory.subcategory,\n            topicName: currentTopic.topic\n          };\n        }\n        return {\n          type: 'subcategory',\n          name: currentSubcategory.subcategory,\n          topicName: currentTopic.topic,\n          categoryName: currentCategory.category\n        };\n      }\n      return {\n        type: 'topic',\n        name: currentTopic.topic,\n        subcategoryName: currentSubcategory.subcategory,\n        categoryName: currentCategory.category\n      };\n    }\n    return null;\n  };\n  const performSave = async qualityAnalysis => {\n    if (!qualityAnalysis) {\n      qualityAnalysis = analyzeResponseQuality(answer);\n    }\n    if (!currentQuestionData || !state.sessionId) {\n      console.error('Missing required data for save');\n      return false;\n    }\n    setIsSaving(true);\n    try {\n      const timeSpent = Math.floor((Date.now() - startTime) / 1000);\n      const response = {\n        sessionId: state.sessionId,\n        questionId: currentQuestionData.questionId,\n        categoryIndex: state.currentPosition.categoryIndex,\n        subcategoryIndex: state.currentPosition.subcategoryIndex,\n        topicIndex: state.currentPosition.topicIndex,\n        questionIndex: state.currentPosition.questionIndex,\n        category: currentQuestionData.category,\n        subcategory: currentQuestionData.subcategory,\n        topic: currentQuestionData.topic,\n        question: currentQuestionData.question,\n        answer: answer.trim(),\n        culturalCommonsense: culturalCommonsense,\n        timeSpent,\n        timestamp: new Date().toISOString(),\n        qualityScore: qualityAnalysis.score\n      };\n      await saveResponse(response);\n\n      // Update user progress with attention check stats\n      if (state.sessionId) {\n        try {\n          await updateUserProgress(state.sessionId, {\n            attentionChecksPassed,\n            attentionChecksFailed,\n            completedQuestions: state.responses.size + 1\n          });\n        } catch (error) {\n          console.error('Failed to update attention check stats:', error);\n        }\n      }\n      setShowSuccess(true);\n      setTimeout(() => setShowSuccess(false), 2000);\n      return true;\n    } catch (error) {\n      console.error('SAVE ERROR:', error);\n      alert('Failed to save response: ' + error.message);\n      return false;\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  // Update the handleSave function to save attention check stats\n  const handleSave = async () => {\n    if (!validateForm() || !currentQuestionData || !state.sessionId) {\n      console.log('Validation failed:', errors);\n      return false;\n    }\n\n    // Quality check - now focused on \"none\" responses\n    const qualityAnalysis = analyzeResponseQuality(answer);\n    const allResponses = Array.from(state.responses.values());\n    allResponses.push({\n      answer: answer.trim(),\n      timeSpent: Math.floor((Date.now() - startTime) / 1000)\n    });\n    const userPatternAnalysis = analyzeUserPattern(allResponses.map(r => ({\n      answer: r.answer,\n      timeSpent: r.timeSpent\n    })));\n\n    // Show quality modal immediately if \"none\" response pattern detected\n    if (userPatternAnalysis.nonePattern.isProblematic && !showQualityModal) {\n      setShowQualityModal(true);\n      return false;\n    }\n    return await performSave(qualityAnalysis);\n  };\n  const handleNext = async () => {\n    const isValid = validateForm();\n    if (!isValid) {\n      console.log('Form validation failed, cannot proceed');\n      return;\n    }\n    const saveSuccessful = await handleSave();\n    if (saveSuccessful && isValid) {\n      const milestone = checkForMilestones();\n      setNavigationDirection('next');\n      setIsNavigating(true);\n      setTimeout(() => {\n        navigateToNext();\n        if (milestone) {\n          setShowCelebration({\n            type: milestone.type,\n            data: milestone\n          });\n        }\n      }, 300);\n    }\n  };\n  const handlePrevious = () => {\n    setNavigationDirection('previous');\n    setIsNavigating(true);\n    setTimeout(() => {\n      navigateToPrevious();\n    }, 300);\n  };\n  const handleSkip = () => {\n    setAnswer('');\n    setCulturalCommonsense(null);\n    setErrors({});\n    setNavigationDirection('next');\n    setIsNavigating(true);\n    setTimeout(() => {\n      navigateToNext();\n    }, 300);\n  };\n\n  // Update attention check completion handler to track stats\n  const handleAttentionCheckComplete = correct => {\n    console.log('=== ATTENTION CHECK COMPLETED ===');\n    console.log('Result:', correct ? 'CORRECT' : 'INCORRECT');\n\n    // Update attention check statistics\n    if (correct) {\n      setAttentionChecksPassed(prev => prev + 1);\n      console.log('Attention check PASSED. Total passed:', attentionChecksPassed + 1);\n    } else {\n      setAttentionChecksFailed(prev => prev + 1);\n      console.log('Attention check FAILED. Total failed:', attentionChecksFailed + 1);\n\n      // Show encouraging message for failed checks\n      setTimeout(() => {\n        alert('Please read questions carefully and pay attention to the survey content. Your responses are valuable for cultural research!');\n      }, 3000);\n    }\n\n    // Clear attention check state immediately\n    setShowAttentionCheck(false);\n    setAttentionCheck(null);\n  };\n  const handleNavigateToQuestion = async (categoryIndex, subcategoryIndex, topicIndex, questionIndex) => {\n    // Save current response if valid\n    const isValid = validateForm();\n    if (isValid && answer.trim() && culturalCommonsense !== null) {\n      console.log('QuestionForm: Saving current response before navigation');\n      await handleSave();\n    }\n\n    // Navigate using the context function\n    console.log('QuestionForm: Navigating to:', categoryIndex, subcategoryIndex, topicIndex, questionIndex);\n    await navigateToPosition(categoryIndex, subcategoryIndex, topicIndex, questionIndex);\n  };\n\n  // Update the quality modal to show none-response specific messaging\n  const handleQualityModalClose = () => {\n    setShowQualityModal(false);\n    if (textareaRef.current) {\n      textareaRef.current.focus();\n    }\n  };\n  const handleQualityModalContinue = async () => {\n    setShowQualityModal(false);\n    const qualityAnalysis = analyzeResponseQuality(answer);\n    await performSave(qualityAnalysis);\n  };\n  const closeCelebration = () => {\n    setShowCelebration(null);\n  };\n\n  // FIXED: Show attention check if needed (with better state management)\n  if (showAttentionCheck && attentionCheck) {\n    console.log('Rendering attention check component');\n    return /*#__PURE__*/_jsxDEV(AttentionCheck, {\n      attentionCheck: attentionCheck,\n      onComplete: handleAttentionCheckComplete\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 12\n    }, this);\n  }\n  if (!currentQuestionData) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gray-100 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"Loading question...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500 mt-2\",\n          children: [\"Questions data length: \", state.questionsData.length]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500\",\n          children: [\"Current position: \", JSON.stringify(state.currentPosition)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 7\n    }, this);\n  }\n  const topicProgress = getTotalQuestionsInCurrentTopic();\n  const completedInTopic = getCompletedQuestionsInCurrentTopic();\n  const currentQuestionInTopic = state.currentPosition.questionIndex + 1;\n  const isFirstQuestion = state.currentPosition.categoryIndex === 0 && state.currentPosition.subcategoryIndex === 0 && state.currentPosition.topicIndex === 0 && state.currentPosition.questionIndex === 0;\n  const isFormValid = answer.trim().length >= 4 && culturalCommonsense !== null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen\",\n    style: {\n      background: `linear-gradient(135deg, var(--bg-primary) 0%, var(--color-cream) 50%, var(--bg-secondary) 100%)`\n    },\n    children: [/*#__PURE__*/_jsxDEV(ProgressBar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed top-20 right-6 z-40\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowNavigationMenu(true),\n        className: \"p-3 rounded-full shadow-lg transition-all duration-200 hover:scale-110\",\n        style: {\n          background: 'var(--btn-primary-bg)',\n          color: 'var(--text-on-dark)'\n        },\n        title: \"Navigation Menu\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xl\",\n          children: \"\\uD83D\\uDDC2\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 479,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 469,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(NavigationMenu, {\n      isOpen: showNavigationMenu,\n      onClose: () => setShowNavigationMenu(false),\n      onNavigateTo: handleNavigateToQuestion\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 484,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(QualityWarningModal, {\n      isOpen: showQualityModal,\n      onClose: handleQualityModalClose,\n      onContinue: handleQualityModalContinue,\n      qualityIssues: qualityWarnings,\n      lowQualityCount: lowQualityCount\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 7\n    }, this), showCelebration && /*#__PURE__*/_jsxDEV(CelebrationModal, {\n      celebration: showCelebration,\n      onClose: closeCelebration\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 501,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-4xl mx-auto px-4 py-6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative overflow-hidden\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `transform transition-all duration-500 ease-in-out ${isNavigating ? navigationDirection === 'next' ? '-translate-x-full opacity-0' : 'translate-x-full opacity-0' : 'translate-x-0 opacity-100'}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"backdrop-blur-sm rounded-2xl shadow-lg p-6 mb-6\",\n            style: {\n              backgroundColor: 'var(--bg-card)',\n              border: '1px solid var(--border-light)'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center mb-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"inline-flex items-center px-4 py-2 text-white rounded-full text-sm font-medium mb-4 shadow-sm\",\n                style: {\n                  background: 'var(--btn-primary-bg)'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"mr-2\",\n                  children: \"\\uD83C\\uDF43\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 533,\n                  columnNumber: 19\n                }, this), \"Question \", currentQuestionInTopic, \" of \", topicProgress]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 527,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n                className: \"text-2xl md:text-3xl font-semibold mb-3\",\n                style: {\n                  color: 'var(--text-primary)'\n                },\n                children: currentQuestionData.topic\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 537,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-center space-x-2 text-sm\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"px-3 py-1 rounded-full font-medium\",\n                  style: {\n                    backgroundColor: 'var(--tag-category-bg)',\n                    color: 'var(--tag-category-text)',\n                    border: '1px solid var(--border-light)'\n                  },\n                  children: currentQuestionData.category\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 545,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  style: {\n                    color: 'var(--text-muted)'\n                  },\n                  children: \"\\u2022\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 555,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"px-3 py-1 rounded-full font-medium\",\n                  style: {\n                    backgroundColor: 'var(--tag-subcategory-bg)',\n                    color: 'var(--tag-subcategory-text)',\n                    border: '1px solid var(--border-light)'\n                  },\n                  children: currentQuestionData.subcategory\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 556,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 544,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 526,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"w-full rounded-full h-2 overflow-hidden\",\n                style: {\n                  backgroundColor: 'var(--bg-progress)'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"h-2 rounded-full transition-all duration-1000 ease-out\",\n                  style: {\n                    background: 'var(--bg-progress-fill)',\n                    width: `${completedInTopic / topicProgress * 100}%`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 575,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 571,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center text-sm mt-2\",\n                style: {\n                  color: 'var(--text-secondary)'\n                },\n                children: [completedInTopic, \" of \", topicProgress, \" questions completed\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 584,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 570,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"backdrop-blur-sm rounded-2xl shadow-lg overflow-hidden\",\n            style: {\n              backgroundColor: 'var(--bg-card)',\n              border: '1px solid var(--border-light)'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-6\",\n              style: {\n                background: 'var(--bg-card-header)',\n                color: 'var(--text-on-dark)'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"text-lg md:text-xl font-medium leading-relaxed\",\n                children: currentQuestionData.question\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 610,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 603,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-6\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex justify-between items-center mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: \"main-answer\",\n                    className: \"block text-base font-medium\",\n                    style: {\n                      color: 'var(--text-primary)'\n                    },\n                    children: \"Your Answer *\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 619,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: handleClear,\n                    className: \"text-sm font-medium hover:underline transition-colors\",\n                    style: {\n                      color: 'var(--accent-warning)'\n                    },\n                    children: \"Clear Form\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 626,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 618,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"relative\",\n                  children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                    ref: textareaRef,\n                    id: \"main-answer\",\n                    value: answer,\n                    onChange: handleAnswerChange,\n                    placeholder: \"Share your knowledge about cultural practices in your region...\",\n                    className: `w-full px-4 py-3 border-2 rounded-xl resize-none min-h-[120px] transition-all duration-200 ${errors.answer ? 'focus:border-red-400' : ''}`,\n                    style: {\n                      color: 'var(--text-primary)',\n                      borderColor: errors.answer ? 'var(--accent-error)' : 'var(--border-medium)',\n                      backgroundColor: 'rgba(244, 228, 202, 0.3)'\n                    },\n                    onFocus: e => {\n                      if (!errors.answer) {\n                        e.target.style.borderColor = 'var(--border-dark)';\n                      }\n                    },\n                    onBlur: e => {\n                      if (!errors.answer) {\n                        e.target.style.borderColor = 'var(--border-medium)';\n                      }\n                    },\n                    maxLength: 5000,\n                    disabled: isSaving\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 636,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: `absolute bottom-3 right-3 px-2 py-1 rounded-lg text-xs border`,\n                    style: {\n                      backgroundColor: answer.length >= 4 ? 'var(--color-cream)' : '#fef3c7',\n                      color: answer.length >= 4 ? 'var(--text-secondary)' : 'var(--accent-warning)',\n                      borderColor: answer.length >= 4 ? 'var(--border-light)' : '#fbbf24'\n                    },\n                    children: [answer.length, \"/5000 \", answer.length < 4 && `(${4 - answer.length} more needed)`]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 665,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 635,\n                  columnNumber: 19\n                }, this), errors.answer && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm mt-2 font-medium\",\n                  style: {\n                    color: 'var(--accent-error)'\n                  },\n                  children: errors.answer\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 678,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 617,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-6 p-4 rounded-xl\",\n                style: {\n                  background: 'linear-gradient(to right, var(--tag-subcategory-bg), var(--tag-category-bg))',\n                  border: '1px solid var(--border-light)'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"font-medium mb-3 text-base\",\n                  style: {\n                    color: 'var(--text-primary)'\n                  },\n                  children: \"\\uD83E\\uDDE0 Cultural Commonsense Assessment\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 692,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm mb-3 leading-relaxed\",\n                  style: {\n                    color: 'var(--text-secondary)'\n                  },\n                  children: \"Cultural commonsense refers to everyday beliefs, behaviors, values, and practices that are perceived as \\\"natural\\\" and widely shared within a cultural group.\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 698,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"font-medium mb-3 text-sm\",\n                  style: {\n                    color: 'var(--text-primary)'\n                  },\n                  children: \"Does this question pertain to cultural commonsense in your region? *\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 705,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center cursor-pointer p-3 rounded-lg hover:bg-white/60 transition-colors\",\n                    onClick: () => handleCulturalChange(true),\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"radio\",\n                      id: \"cultural-yes\",\n                      checked: culturalCommonsense === true,\n                      onChange: () => handleCulturalChange(true),\n                      disabled: isSaving,\n                      className: \"h-4 w-4\",\n                      style: {\n                        accentColor: 'var(--accent-secondary)'\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 717,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                      htmlFor: \"cultural-yes\",\n                      className: \"ml-3 cursor-pointer text-sm\",\n                      style: {\n                        color: 'var(--text-primary)'\n                      },\n                      children: \"\\u2705 Yes, this relates to cultural commonsense\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 726,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 713,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center cursor-pointer p-3 rounded-lg hover:bg-white/60 transition-colors\",\n                    onClick: () => handleCulturalChange(false),\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      type: \"radio\",\n                      id: \"cultural-no\",\n                      checked: culturalCommonsense === false,\n                      onChange: () => handleCulturalChange(false),\n                      disabled: isSaving,\n                      className: \"h-4 w-4\",\n                      style: {\n                        accentColor: 'var(--accent-secondary)'\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 739,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                      htmlFor: \"cultural-no\",\n                      className: \"ml-3 cursor-pointer text-sm\",\n                      style: {\n                        color: 'var(--text-primary)'\n                      },\n                      children: \"\\u274C No, this does not relate to cultural commonsense\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 748,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 735,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 712,\n                  columnNumber: 19\n                }, this), errors.cultural && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm mt-2 font-medium\",\n                  style: {\n                    color: 'var(--accent-error)'\n                  },\n                  children: errors.cultural\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 759,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 685,\n                columnNumber: 17\n              }, this), (qualityWarnings.length > 0 || userPattern.suspiciousPattern) && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-4 p-3 border rounded-xl\",\n                style: {\n                  background: 'var(--btn-warning-bg)',\n                  borderColor: '#fbbf24'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-start\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      color: 'var(--accent-warning)'\n                    },\n                    className: \"mr-2\",\n                    children: \"\\u26A0\\uFE0F\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 775,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm\",\n                    style: {\n                      color: '#92400e'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"font-medium mb-1\",\n                      children: \"Response Quality Notice:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 777,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                      className: \"text-xs space-y-1\",\n                      children: [qualityWarnings.map((warning, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                        children: [\"\\u2022 \", warning]\n                      }, index, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 780,\n                        columnNumber: 29\n                      }, this)), userPattern.warnings.map((warning, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                        children: [\"\\u2022 \", warning]\n                      }, `pattern-${index}`, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 783,\n                        columnNumber: 29\n                      }, this))]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 778,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"mt-2 font-medium\",\n                      children: \"Please provide detailed, thoughtful responses about cultural practices in your region.\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 786,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 776,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 774,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 767,\n                columnNumber: 19\n              }, this), showSuccess && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-4 p-3 border rounded-xl animate-bounce-in\",\n                style: {\n                  background: 'var(--accent-success)',\n                  borderColor: 'var(--border-dark)',\n                  color: 'var(--text-on-dark)'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"mr-2\",\n                    children: \"\\u2728\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 805,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"font-medium text-sm\",\n                    children: \"Response saved successfully!\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 806,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 804,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 796,\n                columnNumber: 19\n              }, this), !isFormValid && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-4 p-3 border rounded-xl\",\n                style: {\n                  background: 'var(--btn-warning-bg)',\n                  borderColor: '#fbbf24'\n                },\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-start\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    style: {\n                      color: 'var(--accent-warning)'\n                    },\n                    className: \"mr-2\",\n                    children: \"\\u26A0\\uFE0F\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 821,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm\",\n                    style: {\n                      color: '#92400e'\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"font-medium mb-1\",\n                      children: \"Please complete the following:\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 823,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                      className: \"text-xs space-y-1\",\n                      children: [answer.trim().length < 4 && /*#__PURE__*/_jsxDEV(\"li\", {\n                        children: \"\\u2022 Add at least 4 characters to your answer\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 825,\n                        columnNumber: 56\n                      }, this), culturalCommonsense === null && /*#__PURE__*/_jsxDEV(\"li\", {\n                        children: \"\\u2022 Select whether this relates to cultural commonsense\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 826,\n                        columnNumber: 60\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 824,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 822,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 820,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 813,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex justify-between items-center pt-4 border-t\",\n                style: {\n                  borderColor: 'var(--border-light)'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: handlePrevious,\n                  disabled: isFirstQuestion || isNavigating,\n                  className: \"flex items-center px-4 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\",\n                  style: {\n                    background: 'var(--btn-warning-bg)',\n                    color: '#92400e'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"mr-2\",\n                    children: \"\\u2190\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 847,\n                    columnNumber: 21\n                  }, this), \"Previous\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 838,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex space-x-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: handleSkip,\n                    disabled: isNavigating,\n                    className: \"px-4 py-2 font-medium rounded-xl transition-all duration-200 text-sm\",\n                    style: {\n                      background: 'var(--btn-warning-bg)',\n                      color: '#92400e'\n                    },\n                    children: \"Skip\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 852,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: handleSave,\n                    disabled: isSaving || !isFormValid || isNavigating,\n                    className: \"px-4 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\",\n                    style: {\n                      background: 'var(--btn-secondary-bg)',\n                      color: 'var(--text-on-dark)'\n                    },\n                    children: isSaving ? 'Saving...' : 'Save'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 864,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: handleNext,\n                    disabled: isSaving || !isFormValid || isNavigating,\n                    className: \"flex items-center px-5 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\",\n                    style: {\n                      background: 'var(--btn-primary-bg)',\n                      color: 'var(--text-on-dark)'\n                    },\n                    children: isNavigating ? 'Moving...' : /*#__PURE__*/_jsxDEV(_Fragment, {\n                      children: [\"Save & Continue\", /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"ml-2\",\n                        children: \"\\u2192\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 888,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 876,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 851,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 834,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 616,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 594,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 509,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 507,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 460,\n    columnNumber: 5\n  }, this);\n}\n\n// Enhanced Celebration Modal Component\n_s(QuestionForm, \"a2QFTVDlpYSxYiJJKOKAmTAdpLQ=\", false, function () {\n  return [useForm];\n});\n_c = QuestionForm;\nfunction CelebrationModal({\n  celebration,\n  onClose\n}) {\n  const celebrations = {\n    topic: {\n      icon: '🎯',\n      title: 'Topic Completed!',\n      emoji: '🌱🌿✨'\n    },\n    subcategory: {\n      icon: '🏆',\n      title: 'Subcategory Mastered!',\n      emoji: '🌿🎋🌟💫'\n    },\n    category: {\n      icon: '👑',\n      title: 'Category Champion!',\n      emoji: '🌿🎋🌟💫✨🎯'\n    }\n  };\n  const config = celebrations[celebration.type];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in p-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"rounded-2xl p-6 max-w-lg mx-auto text-center shadow-2xl animate-bounce-in\",\n      style: {\n        backgroundColor: 'var(--bg-card)',\n        border: '1px solid var(--border-light)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-5xl mb-3\",\n        children: config.icon\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 937,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold mb-3\",\n        style: {\n          color: 'var(--text-primary)'\n        },\n        children: config.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 938,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 rounded-xl mb-4\",\n        style: {\n          background: 'linear-gradient(to right, var(--tag-category-bg), var(--tag-subcategory-bg))',\n          border: '1px solid var(--border-light)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"font-medium text-lg mb-2\",\n          style: {\n            color: 'var(--text-primary)'\n          },\n          children: [\"\\\"\", celebration.data.name, \"\\\"\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 951,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm\",\n          style: {\n            color: 'var(--text-secondary)'\n          },\n          children: [celebration.type === 'topic' && `in ${celebration.data.subcategoryName}`, celebration.type === 'subcategory' && `from ${celebration.data.categoryName}`, celebration.type === 'category' && 'Entire category completed!']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 957,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 944,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-3xl mb-4 animate-pulse\",\n        children: config.emoji\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 966,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        className: \"px-6 py-2 font-medium rounded-xl transition-all duration-200\",\n        style: {\n          background: 'var(--btn-primary-bg)',\n          color: 'var(--text-on-dark)'\n        },\n        children: \"Continue Survey\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 969,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 930,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 929,\n    columnNumber: 5\n  }, this);\n}\n_c2 = CelebrationModal;\nvar _c, _c2;\n$RefreshReg$(_c, \"QuestionForm\");\n$RefreshReg$(_c2, \"CelebrationModal\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useForm","validateAnswer","analyzeResponseQuality","analyzeUserPattern","AttentionCheck","ProgressBar","NavigationMenu","QualityWarningModal","updateUserProgress","jsxDEV","_jsxDEV","Fragment","_Fragment","QuestionForm","_s","state","saveResponse","navigateToNext","navigateToPrevious","getCurrentQuestionData","getTotalQuestionsInCurrentTopic","getCompletedQuestionsInCurrentTopic","resetSession","navigateToPosition","answer","setAnswer","culturalCommonsense","setCulturalCommonsense","errors","setErrors","isSaving","setIsSaving","showAttentionCheck","setShowAttentionCheck","attentionCheck","setAttentionCheck","startTime","setStartTime","Date","now","showSuccess","setShowSuccess","lastQuestionId","setLastQuestionId","isNavigating","setIsNavigating","navigationDirection","setNavigationDirection","showCelebration","setShowCelebration","completedTopicName","setCompletedTopicName","showNavigationMenu","setShowNavigationMenu","lastAttentionCheckAt","setLastAttentionCheckAt","qualityWarnings","setQualityWarnings","showQualityModal","setShowQualityModal","lowQualityCount","setLowQualityCount","userPattern","setUserPattern","suspiciousPattern","warnings","qualityAlertCount","setQualityAlertCount","lastQualityAlertAt","setLastQualityAlertAt","attentionChecksPassed","setAttentionChecksPassed","attentionChecksFailed","setAttentionChecksFailed","textareaRef","currentQuestionData","console","log","questionId","substring","length","responsesCount","responses","size","existingResponse","get","Array","from","values","lowQualityResponses","filter","response","analysis","score","current","style","height","scrollHeight","userPatternAnalysis","map","r","timeSpent","nonePattern","isProblematic","prev","validateForm","newErrors","answerValidation","isValid","message","cultural","Object","keys","handleAnswerChange","e","newValue","target","value","undefined","qualityAnalysis","isLowQuality","issues","handleCulturalChange","handleClear","focus","checkForMilestones","categoryIndex","subcategoryIndex","topicIndex","questionIndex","currentPosition","currentCategory","questionsData","currentSubcategory","subcategories","currentTopic","topics","topic","questions","type","name","category","subcategoryName","subcategory","topicName","categoryName","performSave","sessionId","error","Math","floor","question","trim","timestamp","toISOString","qualityScore","completedQuestions","setTimeout","alert","handleSave","allResponses","push","handleNext","saveSuccessful","milestone","data","handlePrevious","handleSkip","handleAttentionCheckComplete","correct","handleNavigateToQuestion","handleQualityModalClose","handleQualityModalContinue","closeCelebration","onComplete","fileName","_jsxFileName","lineNumber","columnNumber","className","children","JSON","stringify","topicProgress","completedInTopic","currentQuestionInTopic","isFirstQuestion","isFormValid","background","onClick","color","title","isOpen","onClose","onNavigateTo","onContinue","qualityIssues","CelebrationModal","celebration","backgroundColor","border","width","htmlFor","ref","id","onChange","placeholder","borderColor","onFocus","onBlur","maxLength","disabled","checked","accentColor","warning","index","_c","celebrations","icon","emoji","config","_c2","$RefreshReg$"],"sources":["C:/Users/sangm/OneDrive - Brock University/CommonsenseForm/client/src/components/QuestionForm.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useForm } from '../context/FormContext.tsx';\r\nimport { validateAnswer, shouldShowAttentionCheck, generateAttentionCheck, analyzeResponseQuality, analyzeUserPattern } from '../utils/helpers.ts';\r\nimport AttentionCheck from './AttentionCheck.tsx';\r\nimport ProgressBar from './ProgressBar.tsx';\r\nimport NavigationMenu from './NavigationMenu.tsx';\r\nimport QualityWarningModal from './QualityWarningModel.tsx';\r\nimport { updateUserProgress } from '../services/api.ts';\r\n\r\nexport default function QuestionForm() {\r\n  const {\r\n    state,\r\n    saveResponse,\r\n    navigateToNext,\r\n    navigateToPrevious,\r\n    getCurrentQuestionData,\r\n    getTotalQuestionsInCurrentTopic,\r\n    getCompletedQuestionsInCurrentTopic,\r\n    resetSession,\r\n    navigateToPosition\r\n  } = useForm();\r\n\r\n  const [answer, setAnswer] = useState('');\r\n  const [culturalCommonsense, setCulturalCommonsense] = useState<boolean | null>(null);\r\n  const [errors, setErrors] = useState<{ answer?: string; cultural?: string }>({});\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [showAttentionCheck, setShowAttentionCheck] = useState(false);\r\n  const [attentionCheck, setAttentionCheck] = useState<any>(null);\r\n  const [startTime, setStartTime] = useState(Date.now());\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n  const [lastQuestionId, setLastQuestionId] = useState<string | null>(null);\r\n  const [isNavigating, setIsNavigating] = useState(false);\r\n  const [navigationDirection, setNavigationDirection] = useState<'next' | 'previous' | null>(null);\r\n  const [showCelebration, setShowCelebration] = useState<{type: string, data: any} | null>(null);\r\n  const [completedTopicName, setCompletedTopicName] = useState<string>('');\r\n  const [showNavigationMenu, setShowNavigationMenu] = useState(false);\r\n  const [lastAttentionCheckAt, setLastAttentionCheckAt] = useState<number>(0); // Track when we last showed attention check\r\n  \r\n  // Quality tracking states\r\n  const [qualityWarnings, setQualityWarnings] = useState<string[]>([]);\r\n  const [showQualityModal, setShowQualityModal] = useState(false);\r\n  const [lowQualityCount, setLowQualityCount] = useState(0);\r\n  const [userPattern, setUserPattern] = useState<{suspiciousPattern: boolean; warnings: string[]}>({ \r\n    suspiciousPattern: false, \r\n    warnings: [] \r\n  });\r\n\r\n\r\n  // Add these new state variables in the component\r\n  const [qualityAlertCount, setQualityAlertCount] = useState(0);\r\n  const [lastQualityAlertAt, setLastQualityAlertAt] = useState(0);\r\n  const [attentionChecksPassed, setAttentionChecksPassed] = useState(0);\r\n  const [attentionChecksFailed, setAttentionChecksFailed] = useState(0);\r\n\r\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\r\n  const currentQuestionData = getCurrentQuestionData();\r\n\r\n  // Debug logging\r\n  console.log('QuestionForm render:', {\r\n    currentQuestionData: currentQuestionData?.questionId,\r\n    answer: answer.substring(0, 20) + (answer.length > 20 ? '...' : ''),\r\n    culturalCommonsense,\r\n    showAttentionCheck,\r\n    responsesCount: state.responses.size,\r\n    lastAttentionCheckAt\r\n  });\r\n\r\n  // Reset form when question changes\r\n  useEffect(() => {\r\n    if (currentQuestionData && currentQuestionData.questionId !== lastQuestionId) {\r\n      console.log('Question changed, loading data for:', currentQuestionData.questionId);\r\n      \r\n      // Reset form state\r\n      setErrors({});\r\n      setShowSuccess(false);\r\n      setStartTime(Date.now());\r\n      setLastQuestionId(currentQuestionData.questionId);\r\n      setIsNavigating(false);\r\n      setNavigationDirection(null);\r\n      setQualityWarnings([]);\r\n      \r\n      // Load existing response or reset\r\n      const existingResponse = state.responses.get(currentQuestionData.questionId);\r\n      if (existingResponse) {\r\n        console.log('Found existing response:', existingResponse);\r\n        setAnswer(existingResponse.answer);\r\n        setCulturalCommonsense(existingResponse.culturalCommonsense);\r\n      } else {\r\n        console.log('No existing response, clearing form');\r\n        setAnswer('');\r\n        setCulturalCommonsense(null);\r\n      }\r\n    }\r\n  }, [currentQuestionData?.questionId, lastQuestionId, state.responses]);\r\n\r\n  // Calculate low quality count from existing responses\r\n  useEffect(() => {\r\n    const responses = Array.from(state.responses.values());\r\n    const lowQualityResponses = responses.filter(response => {\r\n      const analysis = analyzeResponseQuality(response.answer);\r\n      return analysis.score < 40;\r\n    });\r\n    setLowQualityCount(lowQualityResponses.length);\r\n  }, [state.responses]);\r\n\r\n  useEffect(() => {\r\n    if (textareaRef.current) {\r\n      textareaRef.current.style.height = 'auto';\r\n      textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\r\n    }\r\n  }, [answer]);\r\n\r\n  // Update the quality tracking with immediate alerts and none-response focus\r\nuseEffect(() => {\r\n  if (state.responses.size < 5) return; // Need at least 5 responses to analyze pattern\r\n\r\n  const responses = Array.from(state.responses.values());\r\n  const userPatternAnalysis = analyzeUserPattern(responses.map(r => ({ answer: r.answer, timeSpent: r.timeSpent })));\r\n  \r\n  setUserPattern(userPatternAnalysis);\r\n\r\n  // Show immediate quality alert if \"none\" pattern is problematic\r\n  if (userPatternAnalysis.nonePattern.isProblematic && \r\n      lastQualityAlertAt !== state.responses.size) {\r\n    \r\n    console.log('QUALITY ALERT: None response pattern detected', userPatternAnalysis.nonePattern);\r\n    setShowQualityModal(true);\r\n    setLastQualityAlertAt(state.responses.size);\r\n    setQualityAlertCount(prev => prev + 1);\r\n  }\r\n\r\n  // If user ignored quality warning for 3+ questions, show again\r\n  if (qualityAlertCount > 0 && \r\n      (state.responses.size - lastQualityAlertAt) >= 3 && \r\n      userPatternAnalysis.suspiciousPattern) {\r\n    \r\n    console.log('PERSISTENT QUALITY ISSUES: Showing alert again after 3 questions');\r\n    setShowQualityModal(true);\r\n    setLastQualityAlertAt(state.responses.size);\r\n    setQualityAlertCount(prev => prev + 1);\r\n  }\r\n}, [state.responses.size, lastQualityAlertAt, qualityAlertCount]);\r\n\r\n  const validateForm = () => {\r\n    const newErrors: { answer?: string; cultural?: string } = {};\r\n    \r\n    const answerValidation = validateAnswer(answer);\r\n    if (!answerValidation.isValid) {\r\n      newErrors.answer = answerValidation.message;\r\n    }\r\n\r\n    if (culturalCommonsense === null) {\r\n      newErrors.cultural = 'Please select whether this pertains to cultural commonsense';\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleAnswerChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    const newValue = e.target.value;\r\n    setAnswer(newValue);\r\n    \r\n    if (errors.answer) {\r\n      setErrors(prev => ({ ...prev, answer: undefined }));\r\n    }\r\n\r\n    // Real-time quality analysis\r\n    if (newValue.length > 5) {\r\n      const qualityAnalysis = analyzeResponseQuality(newValue);\r\n      if (qualityAnalysis.isLowQuality) {\r\n        setQualityWarnings(qualityAnalysis.issues);\r\n      } else {\r\n        setQualityWarnings([]);\r\n      }\r\n    } else {\r\n      setQualityWarnings([]);\r\n    }\r\n  };\r\n\r\n  const handleCulturalChange = (value: boolean) => {\r\n    setCulturalCommonsense(value);\r\n    if (errors.cultural) {\r\n      setErrors(prev => ({ ...prev, cultural: undefined }));\r\n    }\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setAnswer('');\r\n    setCulturalCommonsense(null);\r\n    setErrors({});\r\n    setShowSuccess(false);\r\n    setQualityWarnings([]);\r\n    if (textareaRef.current) {\r\n      textareaRef.current.focus();\r\n    }\r\n  };\r\n\r\n  const checkForMilestones = () => {\r\n    const { categoryIndex, subcategoryIndex, topicIndex, questionIndex } = state.currentPosition;\r\n    const currentCategory = state.questionsData[categoryIndex];\r\n    const currentSubcategory = currentCategory?.subcategories[subcategoryIndex];\r\n    const currentTopic = currentSubcategory?.topics[topicIndex];\r\n    \r\n    if (!currentTopic) return null;\r\n\r\n    // Store the current topic name for celebration\r\n    setCompletedTopicName(currentTopic.topic);\r\n\r\n    // Check if this is the last question in the topic\r\n    if (questionIndex === currentTopic.questions.length - 1) {\r\n      // Check if this is also the last topic in subcategory\r\n      if (topicIndex === currentSubcategory.topics.length - 1) {\r\n        // Check if this is also the last subcategory in category\r\n        if (subcategoryIndex === currentCategory.subcategories.length - 1) {\r\n          return {\r\n            type: 'category',\r\n            name: currentCategory.category,\r\n            subcategoryName: currentSubcategory.subcategory,\r\n            topicName: currentTopic.topic\r\n          };\r\n        }\r\n        return {\r\n          type: 'subcategory',\r\n          name: currentSubcategory.subcategory,\r\n          topicName: currentTopic.topic,\r\n          categoryName: currentCategory.category\r\n        };\r\n      }\r\n      return {\r\n        type: 'topic',\r\n        name: currentTopic.topic,\r\n        subcategoryName: currentSubcategory.subcategory,\r\n        categoryName: currentCategory.category\r\n      };\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const performSave = async (qualityAnalysis?: any) => {\r\n  if (!qualityAnalysis) {\r\n    qualityAnalysis = analyzeResponseQuality(answer);\r\n  }\r\n\r\n  if (!currentQuestionData || !state.sessionId) {\r\n    console.error('Missing required data for save');\r\n    return false;\r\n  }\r\n\r\n  setIsSaving(true);\r\n  \r\n  try {\r\n    const timeSpent = Math.floor((Date.now() - startTime) / 1000);\r\n    \r\n    const response = {\r\n      sessionId: state.sessionId,\r\n      questionId: currentQuestionData.questionId,\r\n      categoryIndex: state.currentPosition.categoryIndex,\r\n      subcategoryIndex: state.currentPosition.subcategoryIndex,\r\n      topicIndex: state.currentPosition.topicIndex,\r\n      questionIndex: state.currentPosition.questionIndex,\r\n      category: currentQuestionData.category,\r\n      subcategory: currentQuestionData.subcategory,\r\n      topic: currentQuestionData.topic,\r\n      question: currentQuestionData.question,\r\n      answer: answer.trim(),\r\n      culturalCommonsense: culturalCommonsense!,\r\n      timeSpent,\r\n      timestamp: new Date().toISOString(),\r\n      qualityScore: qualityAnalysis.score\r\n    };\r\n\r\n    await saveResponse(response);\r\n    \r\n    // Update user progress with attention check stats\r\n    if (state.sessionId) {\r\n      try {\r\n        await updateUserProgress(state.sessionId, {\r\n          attentionChecksPassed,\r\n          attentionChecksFailed,\r\n          completedQuestions: state.responses.size + 1\r\n        });\r\n      } catch (error) {\r\n        console.error('Failed to update attention check stats:', error);\r\n      }\r\n    }\r\n    \r\n    setShowSuccess(true);\r\n    setTimeout(() => setShowSuccess(false), 2000);\r\n    return true;\r\n    \r\n  } catch (error) {\r\n    console.error('SAVE ERROR:', error);\r\n    alert('Failed to save response: ' + (error as Error).message);\r\n    return false;\r\n  } finally {\r\n    setIsSaving(false);\r\n  }\r\n};\r\n\r\n  // Update the handleSave function to save attention check stats\r\nconst handleSave = async () => {\r\n  if (!validateForm() || !currentQuestionData || !state.sessionId) {\r\n    console.log('Validation failed:', errors);\r\n    return false;\r\n  }\r\n\r\n  // Quality check - now focused on \"none\" responses\r\n  const qualityAnalysis = analyzeResponseQuality(answer);\r\n  const allResponses = Array.from(state.responses.values());\r\n  allResponses.push({ answer: answer.trim(), timeSpent: Math.floor((Date.now() - startTime) / 1000) } as any);\r\n  \r\n  const userPatternAnalysis = analyzeUserPattern(allResponses.map(r => ({ answer: r.answer, timeSpent: r.timeSpent })));\r\n  \r\n  // Show quality modal immediately if \"none\" response pattern detected\r\n  if (userPatternAnalysis.nonePattern.isProblematic && !showQualityModal) {\r\n    setShowQualityModal(true);\r\n    return false;\r\n  }\r\n\r\n  return await performSave(qualityAnalysis);\r\n};\r\n\r\n  const handleNext = async () => {\r\n    const isValid = validateForm();\r\n    if (!isValid) {\r\n      console.log('Form validation failed, cannot proceed');\r\n      return;\r\n    }\r\n\r\n    const saveSuccessful = await handleSave();\r\n    \r\n    if (saveSuccessful && isValid) {\r\n      const milestone = checkForMilestones();\r\n      \r\n      setNavigationDirection('next');\r\n      setIsNavigating(true);\r\n      \r\n      setTimeout(() => {\r\n        navigateToNext();\r\n        \r\n        if (milestone) {\r\n          setShowCelebration({type: milestone.type, data: milestone});\r\n        }\r\n      }, 300);\r\n    }\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    setNavigationDirection('previous');\r\n    setIsNavigating(true);\r\n    \r\n    setTimeout(() => {\r\n      navigateToPrevious();\r\n    }, 300);\r\n  };\r\n\r\n  const handleSkip = () => {\r\n    setAnswer('');\r\n    setCulturalCommonsense(null);\r\n    setErrors({});\r\n    \r\n    setNavigationDirection('next');\r\n    setIsNavigating(true);\r\n    \r\n    setTimeout(() => {\r\n      navigateToNext();\r\n    }, 300);\r\n  };\r\n\r\n  // Update attention check completion handler to track stats\r\nconst handleAttentionCheckComplete = (correct: boolean) => {\r\n  console.log('=== ATTENTION CHECK COMPLETED ===');\r\n  console.log('Result:', correct ? 'CORRECT' : 'INCORRECT');\r\n  \r\n  // Update attention check statistics\r\n  if (correct) {\r\n    setAttentionChecksPassed(prev => prev + 1);\r\n    console.log('Attention check PASSED. Total passed:', attentionChecksPassed + 1);\r\n  } else {\r\n    setAttentionChecksFailed(prev => prev + 1);\r\n    console.log('Attention check FAILED. Total failed:', attentionChecksFailed + 1);\r\n    \r\n    // Show encouraging message for failed checks\r\n    setTimeout(() => {\r\n      alert('Please read questions carefully and pay attention to the survey content. Your responses are valuable for cultural research!');\r\n    }, 3000);\r\n  }\r\n  \r\n  // Clear attention check state immediately\r\n  setShowAttentionCheck(false);\r\n  setAttentionCheck(null);\r\n};\r\n\r\n  const handleNavigateToQuestion = async (categoryIndex: number, subcategoryIndex: number, topicIndex: number, questionIndex: number) => {\r\n    // Save current response if valid\r\n    const isValid = validateForm();\r\n    if (isValid && answer.trim() && culturalCommonsense !== null) {\r\n      console.log('QuestionForm: Saving current response before navigation');\r\n      await handleSave();\r\n    }\r\n    \r\n    // Navigate using the context function\r\n    console.log('QuestionForm: Navigating to:', categoryIndex, subcategoryIndex, topicIndex, questionIndex);\r\n    await navigateToPosition(categoryIndex, subcategoryIndex, topicIndex, questionIndex);\r\n  };\r\n\r\n  // Update the quality modal to show none-response specific messaging\r\nconst handleQualityModalClose = () => {\r\n  setShowQualityModal(false);\r\n  if (textareaRef.current) {\r\n    textareaRef.current.focus();\r\n  }\r\n};\r\n\r\nconst handleQualityModalContinue = async () => {\r\n  setShowQualityModal(false);\r\n  const qualityAnalysis = analyzeResponseQuality(answer);\r\n  await performSave(qualityAnalysis);\r\n};\r\n\r\n  const closeCelebration = () => {\r\n    setShowCelebration(null);\r\n  };\r\n\r\n  // FIXED: Show attention check if needed (with better state management)\r\n  if (showAttentionCheck && attentionCheck) {\r\n    console.log('Rendering attention check component');\r\n    return <AttentionCheck attentionCheck={attentionCheck} onComplete={handleAttentionCheckComplete} />;\r\n  }\r\n\r\n  if (!currentQuestionData) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Loading question...</p>\r\n          <p className=\"text-sm text-gray-500 mt-2\">\r\n            Questions data length: {state.questionsData.length}\r\n          </p>\r\n          <p className=\"text-sm text-gray-500\">\r\n            Current position: {JSON.stringify(state.currentPosition)}\r\n          </p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const topicProgress = getTotalQuestionsInCurrentTopic();\r\n  const completedInTopic = getCompletedQuestionsInCurrentTopic();\r\n  const currentQuestionInTopic = state.currentPosition.questionIndex + 1;\r\n  const isFirstQuestion = state.currentPosition.categoryIndex === 0 && \r\n                         state.currentPosition.subcategoryIndex === 0 && \r\n                         state.currentPosition.topicIndex === 0 && \r\n                         state.currentPosition.questionIndex === 0;\r\n\r\n  const isFormValid = answer.trim().length >= 4 && culturalCommonsense !== null;\r\n\r\n  return (\r\n    <div \r\n      className=\"min-h-screen\"\r\n      style={{ \r\n        background: `linear-gradient(135deg, var(--bg-primary) 0%, var(--color-cream) 50%, var(--bg-secondary) 100%)` \r\n      }}\r\n    >\r\n      <ProgressBar />\r\n      \r\n      {/* Add Menu Button */}\r\n      <div className=\"fixed top-20 right-6 z-40\">\r\n        <button\r\n          onClick={() => setShowNavigationMenu(true)}\r\n          className=\"p-3 rounded-full shadow-lg transition-all duration-200 hover:scale-110\"\r\n          style={{ \r\n            background: 'var(--btn-primary-bg)',\r\n            color: 'var(--text-on-dark)'\r\n          }}\r\n          title=\"Navigation Menu\"\r\n        >\r\n          <span className=\"text-xl\">🗂️</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Navigation Menu */}\r\n      <NavigationMenu \r\n        isOpen={showNavigationMenu}\r\n        onClose={() => setShowNavigationMenu(false)}\r\n        onNavigateTo={handleNavigateToQuestion}\r\n      />\r\n\r\n      {/* Quality Warning Modal */}\r\n      <QualityWarningModal\r\n        isOpen={showQualityModal}\r\n        onClose={handleQualityModalClose}\r\n        onContinue={handleQualityModalContinue}\r\n        qualityIssues={qualityWarnings}\r\n        lowQualityCount={lowQualityCount}\r\n      />\r\n      \r\n      {/* Celebration Modal */}\r\n      {showCelebration && (\r\n        <CelebrationModal \r\n          celebration={showCelebration} \r\n          onClose={closeCelebration}\r\n        />\r\n      )}\r\n      \r\n      <div className=\"max-w-4xl mx-auto px-4 py-6\">\r\n        {/* Question Card Container */}\r\n        <div className=\"relative overflow-hidden\">\r\n          <div className={`transform transition-all duration-500 ease-in-out ${\r\n            isNavigating \r\n              ? navigationDirection === 'next' \r\n                ? '-translate-x-full opacity-0'\r\n                : 'translate-x-full opacity-0'\r\n              : 'translate-x-0 opacity-100'\r\n          }`}>\r\n            \r\n            {/* Topic Header Card */}\r\n            <div \r\n              className=\"backdrop-blur-sm rounded-2xl shadow-lg p-6 mb-6\"\r\n              style={{ \r\n                backgroundColor: 'var(--bg-card)',\r\n                border: '1px solid var(--border-light)'\r\n              }}\r\n            >\r\n              <div className=\"text-center mb-4\">\r\n                <div \r\n                  className=\"inline-flex items-center px-4 py-2 text-white rounded-full text-sm font-medium mb-4 shadow-sm\"\r\n                  style={{ \r\n                    background: 'var(--btn-primary-bg)' \r\n                  }}\r\n                >\r\n                  <span className=\"mr-2\">🍃</span>\r\n                  Question {currentQuestionInTopic} of {topicProgress}\r\n                </div>\r\n                \r\n                <h1 \r\n                  className=\"text-2xl md:text-3xl font-semibold mb-3\"\r\n                  style={{ color: 'var(--text-primary)' }}\r\n                >\r\n                  {currentQuestionData.topic}\r\n                </h1>\r\n                \r\n                <div className=\"flex items-center justify-center space-x-2 text-sm\">\r\n                  <span \r\n                    className=\"px-3 py-1 rounded-full font-medium\"\r\n                    style={{ \r\n                      backgroundColor: 'var(--tag-category-bg)',\r\n                      color: 'var(--tag-category-text)',\r\n                      border: '1px solid var(--border-light)'\r\n                    }}\r\n                  >\r\n                    {currentQuestionData.category}\r\n                  </span>\r\n                  <span style={{ color: 'var(--text-muted)' }}>•</span>\r\n                  <span \r\n                    className=\"px-3 py-1 rounded-full font-medium\"\r\n                    style={{ \r\n                      backgroundColor: 'var(--tag-subcategory-bg)',\r\n                      color: 'var(--tag-subcategory-text)',\r\n                      border: '1px solid var(--border-light)'\r\n                    }}\r\n                  >\r\n                    {currentQuestionData.subcategory}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Topic Progress Bar */}\r\n              <div className=\"relative\">\r\n                <div \r\n                  className=\"w-full rounded-full h-2 overflow-hidden\"\r\n                  style={{ backgroundColor: 'var(--bg-progress)' }}\r\n                >\r\n                  <div \r\n                    className=\"h-2 rounded-full transition-all duration-1000 ease-out\"\r\n                    style={{ \r\n                      background: 'var(--bg-progress-fill)',\r\n                      width: `${(completedInTopic / topicProgress) * 100}%` \r\n                    }}\r\n                  ></div>\r\n                </div>\r\n                \r\n                <div \r\n                  className=\"text-center text-sm mt-2\"\r\n                  style={{ color: 'var(--text-secondary)' }}\r\n                >\r\n                  {completedInTopic} of {topicProgress} questions completed\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Main Question Card */}\r\n            <div \r\n              className=\"backdrop-blur-sm rounded-2xl shadow-lg overflow-hidden\"\r\n              style={{ \r\n                backgroundColor: 'var(--bg-card)',\r\n                border: '1px solid var(--border-light)'\r\n              }}\r\n            >\r\n              \r\n              {/* Question Header */}\r\n              <div \r\n                className=\"p-6\"\r\n                style={{ \r\n                  background: 'var(--bg-card-header)',\r\n                  color: 'var(--text-on-dark)'\r\n                }}\r\n              >\r\n                <h2 className=\"text-lg md:text-xl font-medium leading-relaxed\">\r\n                  {currentQuestionData.question}\r\n                </h2>\r\n              </div>\r\n\r\n              {/* Answer Section */}\r\n              <div className=\"p-6\">\r\n                <div className=\"mb-6\">\r\n                  <div className=\"flex justify-between items-center mb-3\">\r\n                    <label \r\n                      htmlFor=\"main-answer\" \r\n                      className=\"block text-base font-medium\"\r\n                      style={{ color: 'var(--text-primary)' }}\r\n                    >\r\n                      Your Answer *\r\n                    </label>\r\n                    <button\r\n                      onClick={handleClear}\r\n                      className=\"text-sm font-medium hover:underline transition-colors\"\r\n                      style={{ color: 'var(--accent-warning)' }}\r\n                    >\r\n                      Clear Form\r\n                    </button>\r\n                  </div>\r\n                  \r\n                  <div className=\"relative\">\r\n                    <textarea\r\n                      ref={textareaRef}\r\n                      id=\"main-answer\"\r\n                      value={answer}\r\n                      onChange={handleAnswerChange}\r\n                      placeholder=\"Share your knowledge about cultural practices in your region...\"\r\n                      className={`w-full px-4 py-3 border-2 rounded-xl resize-none min-h-[120px] transition-all duration-200 ${\r\n                        errors.answer ? 'focus:border-red-400' : ''\r\n                      }`}\r\n                      style={{\r\n                        color: 'var(--text-primary)',\r\n                        borderColor: errors.answer ? 'var(--accent-error)' : 'var(--border-medium)',\r\n                        backgroundColor: 'rgba(244, 228, 202, 0.3)'\r\n                      }}\r\n                      onFocus={(e) => {\r\n                        if (!errors.answer) {\r\n                          e.target.style.borderColor = 'var(--border-dark)';\r\n                        }\r\n                      }}\r\n                      onBlur={(e) => {\r\n                        if (!errors.answer) {\r\n                          e.target.style.borderColor = 'var(--border-medium)';\r\n                        }\r\n                      }}\r\n                      maxLength={5000}\r\n                      disabled={isSaving}\r\n                    />\r\n                    \r\n                    {/* Character count badge */}\r\n                    <div \r\n                      className={`absolute bottom-3 right-3 px-2 py-1 rounded-lg text-xs border`}\r\n                      style={{\r\n                        backgroundColor: answer.length >= 4 ? 'var(--color-cream)' : '#fef3c7',\r\n                        color: answer.length >= 4 ? 'var(--text-secondary)' : 'var(--accent-warning)',\r\n                        borderColor: answer.length >= 4 ? 'var(--border-light)' : '#fbbf24'\r\n                      }}\r\n                    >\r\n                      {answer.length}/5000 {answer.length < 4 && `(${4 - answer.length} more needed)`}\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {errors.answer && (\r\n                    <p className=\"text-sm mt-2 font-medium\" style={{ color: 'var(--accent-error)' }}>\r\n                      {errors.answer}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Cultural Commonsense Section */}\r\n                <div \r\n                  className=\"mb-6 p-4 rounded-xl\"\r\n                  style={{ \r\n                    background: 'linear-gradient(to right, var(--tag-subcategory-bg), var(--tag-category-bg))',\r\n                    border: '1px solid var(--border-light)'\r\n                  }}\r\n                >\r\n                  <h3 \r\n                    className=\"font-medium mb-3 text-base\"\r\n                    style={{ color: 'var(--text-primary)' }}\r\n                  >\r\n                    🧠 Cultural Commonsense Assessment\r\n                  </h3>\r\n                  <p \r\n                    className=\"text-sm mb-3 leading-relaxed\"\r\n                    style={{ color: 'var(--text-secondary)' }}\r\n                  >\r\n                    Cultural commonsense refers to everyday beliefs, behaviors, values, and practices \r\n                    that are perceived as \"natural\" and widely shared within a cultural group.\r\n                  </p>\r\n                  <p \r\n                    className=\"font-medium mb-3 text-sm\"\r\n                    style={{ color: 'var(--text-primary)' }}\r\n                  >\r\n                    Does this question pertain to cultural commonsense in your region? *\r\n                  </p>\r\n                  \r\n                  <div className=\"space-y-2\">\r\n                    <div \r\n                      className=\"flex items-center cursor-pointer p-3 rounded-lg hover:bg-white/60 transition-colors\"\r\n                      onClick={() => handleCulturalChange(true)}\r\n                    >\r\n                      <input\r\n                        type=\"radio\"\r\n                        id=\"cultural-yes\"\r\n                        checked={culturalCommonsense === true}\r\n                        onChange={() => handleCulturalChange(true)}\r\n                        disabled={isSaving}\r\n                        className=\"h-4 w-4\"\r\n                        style={{ accentColor: 'var(--accent-secondary)' }}\r\n                      />\r\n                      <label \r\n                        htmlFor=\"cultural-yes\" \r\n                        className=\"ml-3 cursor-pointer text-sm\"\r\n                        style={{ color: 'var(--text-primary)' }}\r\n                      >\r\n                        ✅ Yes, this relates to cultural commonsense\r\n                      </label>\r\n                    </div>\r\n                    \r\n                    <div \r\n                      className=\"flex items-center cursor-pointer p-3 rounded-lg hover:bg-white/60 transition-colors\"\r\n                      onClick={() => handleCulturalChange(false)}\r\n                    >\r\n                      <input\r\n                        type=\"radio\"\r\n                        id=\"cultural-no\"\r\n                        checked={culturalCommonsense === false}\r\n                        onChange={() => handleCulturalChange(false)}\r\n                        disabled={isSaving}\r\n                        className=\"h-4 w-4\"\r\n                        style={{ accentColor: 'var(--accent-secondary)' }}\r\n                      />\r\n                      <label \r\n                        htmlFor=\"cultural-no\" \r\n                        className=\"ml-3 cursor-pointer text-sm\"\r\n                        style={{ color: 'var(--text-primary)' }}\r\n                      >\r\n                        ❌ No, this does not relate to cultural commonsense\r\n                      </label>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {errors.cultural && (\r\n                    <p className=\"text-sm mt-2 font-medium\" style={{ color: 'var(--accent-error)' }}>\r\n                      {errors.cultural}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Quality Warnings */}\r\n                {(qualityWarnings.length > 0 || userPattern.suspiciousPattern) && (\r\n                  <div \r\n                    className=\"mb-4 p-3 border rounded-xl\"\r\n                    style={{ \r\n                      background: 'var(--btn-warning-bg)',\r\n                      borderColor: '#fbbf24'\r\n                    }}\r\n                  >\r\n                    <div className=\"flex items-start\">\r\n                      <span style={{ color: 'var(--accent-warning)' }} className=\"mr-2\">⚠️</span>\r\n                      <div className=\"text-sm\" style={{ color: '#92400e' }}>\r\n                        <p className=\"font-medium mb-1\">Response Quality Notice:</p>\r\n                        <ul className=\"text-xs space-y-1\">\r\n                          {qualityWarnings.map((warning, index) => (\r\n                            <li key={index}>• {warning}</li>\r\n                          ))}\r\n                          {userPattern.warnings.map((warning, index) => (\r\n                            <li key={`pattern-${index}`}>• {warning}</li>\r\n                          ))}\r\n                        </ul>\r\n                        <p className=\"mt-2 font-medium\">\r\n                          Please provide detailed, thoughtful responses about cultural practices in your region.\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Success Message */}\r\n                {showSuccess && (\r\n                  <div \r\n                    className=\"mb-4 p-3 border rounded-xl animate-bounce-in\"\r\n                    style={{ \r\n                      background: 'var(--accent-success)',\r\n                      borderColor: 'var(--border-dark)',\r\n                      color: 'var(--text-on-dark)'\r\n                    }}\r\n                  >\r\n                    <div className=\"flex items-center\">\r\n                      <span className=\"mr-2\">✨</span>\r\n                      <span className=\"font-medium text-sm\">Response saved successfully!</span>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Validation Warning */}\r\n                {!isFormValid && (\r\n                  <div \r\n                    className=\"mb-4 p-3 border rounded-xl\"\r\n                    style={{ \r\n                      background: 'var(--btn-warning-bg)',\r\n                      borderColor: '#fbbf24'\r\n                    }}\r\n                  >\r\n                    <div className=\"flex items-start\">\r\n                      <span style={{ color: 'var(--accent-warning)' }} className=\"mr-2\">⚠️</span>\r\n                      <div className=\"text-sm\" style={{ color: '#92400e' }}>\r\n                        <p className=\"font-medium mb-1\">Please complete the following:</p>\r\n                        <ul className=\"text-xs space-y-1\">\r\n                          {answer.trim().length < 4 && <li>• Add at least 4 characters to your answer</li>}\r\n                          {culturalCommonsense === null && <li>• Select whether this relates to cultural commonsense</li>}\r\n                        </ul>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Navigation Buttons */}\r\n                <div \r\n                  className=\"flex justify-between items-center pt-4 border-t\"\r\n                  style={{ borderColor: 'var(--border-light)' }}\r\n                >\r\n                  <button\r\n                    onClick={handlePrevious}\r\n                    disabled={isFirstQuestion || isNavigating}\r\n                    className=\"flex items-center px-4 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\"\r\n                    style={{ \r\n                      background: 'var(--btn-warning-bg)',\r\n                      color: '#92400e'\r\n                    }}\r\n                  >\r\n                    <span className=\"mr-2\">←</span>\r\n                    Previous\r\n                  </button>\r\n\r\n                  <div className=\"flex space-x-3\">\r\n                    <button\r\n                      onClick={handleSkip}\r\n                      disabled={isNavigating}\r\n                      className=\"px-4 py-2 font-medium rounded-xl transition-all duration-200 text-sm\"\r\n                      style={{ \r\n                        background: 'var(--btn-warning-bg)',\r\n                        color: '#92400e'\r\n                      }}\r\n                    >\r\n                      Skip\r\n                    </button>\r\n\r\n                    <button\r\n                      onClick={handleSave}\r\n                      disabled={isSaving || !isFormValid || isNavigating}\r\n                      className=\"px-4 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\"\r\n                      style={{ \r\n                        background: 'var(--btn-secondary-bg)',\r\n                        color: 'var(--text-on-dark)'\r\n                      }}\r\n                    >\r\n                      {isSaving ? 'Saving...' : 'Save'}\r\n                    </button>\r\n\r\n                    <button\r\n                      onClick={handleNext}\r\n                      disabled={isSaving || !isFormValid || isNavigating}\r\n                      className=\"flex items-center px-5 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\"\r\n                      style={{ \r\n                        background: 'var(--btn-primary-bg)',\r\n                        color: 'var(--text-on-dark)'\r\n                      }}\r\n                    >\r\n                      {isNavigating ? 'Moving...' : (\r\n                        <>\r\n                          Save & Continue\r\n                          <span className=\"ml-2\">→</span>\r\n                        </>\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Enhanced Celebration Modal Component\r\nfunction CelebrationModal({ celebration, onClose }: { \r\n  celebration: {type: string, data: any}, \r\n  onClose: () => void \r\n}) {\r\n  const celebrations = {\r\n    topic: {\r\n      icon: '🎯',\r\n      title: 'Topic Completed!',\r\n      emoji: '🌱🌿✨',\r\n    },\r\n    subcategory: {\r\n      icon: '🏆',\r\n      title: 'Subcategory Mastered!',\r\n      emoji: '🌿🎋🌟💫',\r\n    },\r\n    category: {\r\n      icon: '👑',\r\n      title: 'Category Champion!',\r\n      emoji: '🌿🎋🌟💫✨🎯',\r\n    }\r\n  };\r\n\r\n  const config = celebrations[celebration.type as keyof typeof celebrations];\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in p-4\">\r\n      <div \r\n        className=\"rounded-2xl p-6 max-w-lg mx-auto text-center shadow-2xl animate-bounce-in\"\r\n        style={{ \r\n          backgroundColor: 'var(--bg-card)',\r\n          border: '1px solid var(--border-light)'\r\n        }}\r\n      >\r\n        <div className=\"text-5xl mb-3\">{config.icon}</div>\r\n        <h2 \r\n          className=\"text-2xl font-bold mb-3\"\r\n          style={{ color: 'var(--text-primary)' }}\r\n        >\r\n          {config.title}\r\n        </h2>\r\n        <div \r\n          className=\"p-4 rounded-xl mb-4\"\r\n          style={{ \r\n            background: 'linear-gradient(to right, var(--tag-category-bg), var(--tag-subcategory-bg))',\r\n            border: '1px solid var(--border-light)'\r\n          }}\r\n        >\r\n          <p \r\n            className=\"font-medium text-lg mb-2\"\r\n            style={{ color: 'var(--text-primary)' }}\r\n          >\r\n            \"{celebration.data.name}\"\r\n          </p>\r\n          <p \r\n            className=\"text-sm\"\r\n            style={{ color: 'var(--text-secondary)' }}\r\n          >\r\n            {celebration.type === 'topic' && `in ${celebration.data.subcategoryName}`}\r\n            {celebration.type === 'subcategory' && `from ${celebration.data.categoryName}`}\r\n            {celebration.type === 'category' && 'Entire category completed!'}\r\n          </p>\r\n        </div>\r\n        <div className=\"text-3xl mb-4 animate-pulse\">\r\n          {config.emoji}\r\n        </div>\r\n        <button\r\n          onClick={onClose}\r\n          className=\"px-6 py-2 font-medium rounded-xl transition-all duration-200\"\r\n          style={{ \r\n            background: 'var(--btn-primary-bg)',\r\n            color: 'var(--text-on-dark)'\r\n          }}\r\n        >\r\n          Continue Survey\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}