{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sangm\\\\OneDrive - Brock University\\\\CommonsenseForm\\\\client\\\\src\\\\components\\\\UserInfo.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { REGIONS } from '../types/index.ts';\nimport { checkProlificIdExists } from '../services/api.ts';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function UserInfoForm({\n  onSubmit,\n  isLoading\n}) {\n  _s();\n  const [formData, setFormData] = useState({\n    prolificId: '',\n    region: 'North',\n    age: 0,\n    yearsInRegion: 0\n  });\n  const [errors, setErrors] = useState({});\n\n  // NEW: State for Prolific ID checking\n  const [isCheckingProlificId, setIsCheckingProlificId] = useState(false);\n  const [prolificIdExists, setProlificIdExists] = useState(false);\n  const [prolificIdCheckComplete, setProlificIdCheckComplete] = useState(false);\n\n  // Real-time Prolific ID validation\n  const validateProlificId = id => {\n    if (!id) {\n      return 'Prolific ID is required';\n    }\n    if (id.length !== 24) {\n      return `Prolific ID must be exactly 24 characters (current: ${id.length})`;\n    }\n    if (!/^[a-zA-Z0-9]+$/.test(id)) {\n      return 'Prolific ID can only contain letters and numbers (no symbols or spaces)';\n    }\n    return '';\n  };\n\n  // NEW: Debounced function to check if Prolific ID exists\n  const checkProlificIdDebounced = useCallback(debounce(async id => {\n    if (id.length === 24 && /^[a-zA-Z0-9]+$/.test(id)) {\n      setIsCheckingProlificId(true);\n      try {\n        const exists = await checkProlificIdExists(id);\n        setProlificIdExists(exists);\n        setProlificIdCheckComplete(true);\n        if (exists) {\n          setErrors(prev => ({\n            ...prev,\n            prolificId: 'This Prolific ID has already been used. Please check your ID or contact support if you believe this is an error.'\n          }));\n        } else {\n          // Clear any existing error if the ID is available\n          setErrors(prev => {\n            var _newErrors$prolificId;\n            const newErrors = {\n              ...prev\n            };\n            if ((_newErrors$prolificId = newErrors.prolificId) !== null && _newErrors$prolificId !== void 0 && _newErrors$prolificId.includes('already been used')) {\n              delete newErrors.prolificId;\n            }\n            return newErrors;\n          });\n        }\n      } catch (error) {\n        console.error('Error checking Prolific ID:', error);\n        // On error, we don't block the user but log the issue\n        setProlificIdExists(false);\n        setProlificIdCheckComplete(true);\n      } finally {\n        setIsCheckingProlificId(false);\n      }\n    } else {\n      setProlificIdCheckComplete(false);\n      setProlificIdExists(false);\n    }\n  }, 800),\n  // 800ms delay\n  []);\n\n  // NEW: Effect to check Prolific ID when it changes\n  useEffect(() => {\n    if (formData.prolificId) {\n      setProlificIdCheckComplete(false);\n      checkProlificIdDebounced(formData.prolificId);\n    } else {\n      setProlificIdCheckComplete(false);\n      setProlificIdExists(false);\n    }\n  }, [formData.prolificId, checkProlificIdDebounced]);\n  const validateForm = () => {\n    const newErrors = {};\n\n    // Validate Prolific ID\n    const prolificError = validateProlificId(formData.prolificId);\n    if (prolificError) {\n      newErrors.prolificId = prolificError;\n    } else if (prolificIdExists) {\n      newErrors.prolificId = 'This Prolific ID has already been used. Please check your ID or contact support if you believe this is an error.';\n    }\n    if (!formData.region) {\n      newErrors.region = 'Please select your region';\n    }\n    if (!formData.age || formData.age < 18 || formData.age > 100) {\n      newErrors.age = 'Please enter a valid age (18-100)';\n    }\n    if (formData.yearsInRegion < 0 || formData.yearsInRegion > formData.age) {\n      newErrors.yearsInRegion = 'Years in region cannot exceed your age';\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n  const handleSubmit = e => {\n    e.preventDefault();\n    if (validateForm() && !prolificIdExists) {\n      onSubmit(formData);\n    }\n  };\n  const handleRegionChange = region => {\n    setFormData(prev => ({\n      ...prev,\n      region\n    }));\n    if (errors.region) {\n      setErrors(prev => ({\n        ...prev,\n        region: undefined\n      }));\n    }\n  };\n  const handleProlificIdChange = value => {\n    // Remove any non-alphanumeric characters and limit to 24\n    const cleanValue = value.replace(/[^a-zA-Z0-9]/g, '').slice(0, 24);\n    setFormData(prev => ({\n      ...prev,\n      prolificId: cleanValue\n    }));\n\n    // Clear format validation errors when user starts typing\n    if (errors.prolificId && !errors.prolificId.includes('already been used')) {\n      setErrors(prev => ({\n        ...prev,\n        prolificId: undefined\n      }));\n    }\n  };\n\n  // UPDATED: Check if form is valid (now includes Prolific ID existence check)\n  const isFormValid = Object.keys(errors).length === 0 && formData.prolificId.length === 24 && formData.region && formData.age && formData.yearsInRegion >= 0 && !prolificIdExists && prolificIdCheckComplete; // Must have completed the check\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-custom-cream flex items-center justify-center p-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-2xl mx-auto bg-white rounded-2xl shadow-xl p-8 md:p-12 animate-fade-in\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center mb-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-3xl md:text-4xl font-bold text-custom-dark-brown mb-4\",\n          children: \"Tell us about yourself\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-custom-olive\",\n          children: \"This information helps us understand the regional context of your responses\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"space-y-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-lg font-semibold text-custom-dark-brown mb-2\",\n            children: [\"Prolific ID \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-red-500\",\n              children: \"*\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 27\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-custom-olive mb-4\",\n            children: \"Enter your Prolific participant ID\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"relative\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: formData.prolificId,\n              onChange: e => handleProlificIdChange(e.target.value),\n              placeholder: \"e.g., 507f1f77bcf86cd799439011\",\n              className: `w-full px-4 py-3 text-lg rounded-lg border-2 transition-all duration-200 font-mono pr-12\n                  ${errors.prolificId ? 'border-red-500 focus:ring-red-500 focus:border-red-500' : formData.prolificId.length === 24 && prolificIdCheckComplete && !prolificIdExists ? 'border-green-500 focus:ring-green-500 focus:border-green-500' : 'border-custom-blue-gray focus:ring-custom-olive focus:border-custom-olive'} focus:ring-2`,\n              maxLength: 24,\n              autoComplete: \"off\",\n              style: {\n                color: 'var(--color-dark-brown)'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"absolute inset-y-0 right-0 pr-3 flex items-center\",\n              children: isCheckingProlificId ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-5 w-5 border-b-2 border-custom-olive\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 19\n              }, this) : formData.prolificId.length === 24 && prolificIdCheckComplete ? prolificIdExists ? /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-red-500 text-xl\",\n                children: \"\\u274C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-500 text-xl\",\n                children: \"\\u2705\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 200,\n                columnNumber: 21\n              }, this) : null\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 13\n          }, this), isCheckingProlificId && formData.prolificId.length === 24 && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-custom-olive text-sm mt-2 flex items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"animate-spin rounded-full h-4 w-4 border-b-2 border-custom-olive mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 17\n            }, this), \"Checking ID availability...\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 15\n          }, this), prolificIdCheckComplete && formData.prolificId.length === 24 && !prolificIdExists && !errors.prolificId && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-green-600 text-sm mt-2 flex items-center\",\n            children: \"\\u2705 Prolific ID is available\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 15\n          }, this), errors.prolificId && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-red-600 text-sm mt-2 flex items-center\",\n            children: [\"\\u26A0\\uFE0F \", errors.prolificId]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-lg font-semibold text-custom-dark-brown mb-4\",\n            children: \"Which region of India are you from? *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-4\",\n            children: Object.entries(REGIONS).map(([region, states]) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative\",\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"flex items-start space-x-3 cursor-pointer p-4 border-2 border-custom-blue-gray rounded-lg hover:bg-custom-blue-gray hover:bg-opacity-30 transition-colors\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  name: \"region\",\n                  value: region,\n                  checked: formData.region === region,\n                  onChange: () => handleRegionChange(region),\n                  className: \"mt-1 h-4 w-4 text-custom-olive focus:ring-custom-olive border-custom-olive\",\n                  style: {\n                    accentColor: 'var(--color-olive)'\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex-1\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"font-medium text-custom-dark-brown\",\n                    children: [region, \" India\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 249,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-sm text-custom-olive mt-1\",\n                    children: states.join(', ')\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 19\n              }, this)\n            }, region, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 13\n          }, this), errors.region && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mt-2 text-sm text-red-600\",\n            children: errors.region\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"age\",\n            className: \"block text-lg font-semibold text-custom-dark-brown mb-2\",\n            children: \"What is your age? *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            id: \"age\",\n            min: \"18\",\n            max: \"100\",\n            value: formData.age || '',\n            onChange: e => {\n              const newAge = parseInt(e.target.value) || 0;\n              setFormData(prev => ({\n                ...prev,\n                age: newAge\n              }));\n              if (errors.age) {\n                setErrors(prev => ({\n                  ...prev,\n                  age: undefined\n                }));\n              }\n            },\n            className: \"w-full px-4 py-3 border-2 border-custom-blue-gray rounded-lg focus:ring-2 focus:ring-custom-olive focus:border-custom-olive text-lg text-custom-dark-brown placeholder-custom-olive placeholder-opacity-60\",\n            placeholder: \"Enter your age\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }, this), errors.age && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mt-2 text-sm text-red-600\",\n            children: errors.age\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"yearsInRegion\",\n            className: \"block text-lg font-semibold text-custom-dark-brown mb-2\",\n            children: \"How many years have you lived in this region? *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            id: \"yearsInRegion\",\n            min: \"0\",\n            max: formData.age || 100,\n            value: formData.yearsInRegion || '',\n            onChange: e => {\n              const newYears = parseInt(e.target.value) || 0;\n              setFormData(prev => ({\n                ...prev,\n                yearsInRegion: newYears\n              }));\n              if (errors.yearsInRegion) {\n                setErrors(prev => ({\n                  ...prev,\n                  yearsInRegion: undefined\n                }));\n              }\n            },\n            className: \"w-full px-4 py-3 border-2 border-custom-blue-gray rounded-lg focus:ring-2 focus:ring-custom-olive focus:border-custom-olive text-lg text-custom-dark-brown placeholder-custom-olive placeholder-opacity-60\",\n            placeholder: \"Enter number of years\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 13\n          }, this), errors.yearsInRegion && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mt-2 text-sm text-red-600\",\n            children: errors.yearsInRegion\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mt-2 text-sm text-custom-olive\",\n            children: \"This includes childhood and any time spent living in this region\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pt-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: isLoading || !isFormValid || isCheckingProlificId,\n            className: `w-full font-bold py-4 px-6 rounded-xl text-lg transition-all duration-200 shadow-lg hover:shadow-xl ${isFormValid && !isLoading && !isCheckingProlificId ? 'text-white transform hover:scale-105' : 'text-gray-500 bg-gray-300 cursor-not-allowed'}`,\n            style: {\n              background: isLoading || !isFormValid || isCheckingProlificId ? '#d1d5db' : 'var(--btn-primary-bg)',\n              backgroundImage: isLoading || !isFormValid || isCheckingProlificId ? 'none' : 'var(--btn-primary-bg)'\n            },\n            onMouseEnter: e => {\n              if (!isLoading && isFormValid && !isCheckingProlificId) {\n                e.currentTarget.style.backgroundImage = 'var(--btn-primary-hover)';\n              }\n            },\n            onMouseLeave: e => {\n              if (!isLoading && isFormValid && !isCheckingProlificId) {\n                e.currentTarget.style.backgroundImage = 'var(--btn-primary-bg)';\n              }\n            },\n            children: isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-6 w-6 border-b-2 border-white mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 348,\n                columnNumber: 19\n              }, this), \"Creating your session...\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 347,\n              columnNumber: 17\n            }, this) : isCheckingProlificId ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-400 mr-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 353,\n                columnNumber: 19\n              }, this), \"Checking ID...\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 17\n            }, this) : 'Start Survey'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 13\n          }, this), prolificIdExists && formData.prolificId.length === 24 && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-center text-sm text-red-600 mt-3\",\n            children: \"Cannot proceed - this Prolific ID has already been used\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-6 text-center text-sm text-custom-olive\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"All information is kept confidential and used only for research purposes.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 371,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 152,\n    columnNumber: 5\n  }, this);\n}\n\n// NEW: Debounce utility function\n_s(UserInfoForm, \"qgJnOjNkKo6yNVMerbQ0zEGgdJ8=\");\n_c = UserInfoForm;\nfunction debounce(func, wait) {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func.apply(null, args), wait);\n  };\n}\nvar _c;\n$RefreshReg$(_c, \"UserInfoForm\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","REGIONS","checkProlificIdExists","jsxDEV","_jsxDEV","UserInfoForm","onSubmit","isLoading","_s","formData","setFormData","prolificId","region","age","yearsInRegion","errors","setErrors","isCheckingProlificId","setIsCheckingProlificId","prolificIdExists","setProlificIdExists","prolificIdCheckComplete","setProlificIdCheckComplete","validateProlificId","id","length","test","checkProlificIdDebounced","debounce","exists","prev","_newErrors$prolificId","newErrors","includes","error","console","validateForm","prolificError","Object","keys","handleSubmit","e","preventDefault","handleRegionChange","undefined","handleProlificIdChange","value","cleanValue","replace","slice","isFormValid","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","onChange","target","placeholder","maxLength","autoComplete","style","color","entries","map","states","name","checked","accentColor","join","htmlFor","min","max","newAge","parseInt","newYears","disabled","background","backgroundImage","onMouseEnter","currentTarget","onMouseLeave","_c","func","wait","timeout","args","clearTimeout","setTimeout","apply","$RefreshReg$"],"sources":["C:/Users/sangm/OneDrive - Brock University/CommonsenseForm/client/src/components/UserInfo.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { UserInfo, UserInfoErrors, REGIONS } from '../types/index.ts';\r\nimport { checkProlificIdExists } from '../services/api.ts';\r\n\r\ninterface UserInfoProps {\r\n  onSubmit: (userInfo: UserInfo) => void;\r\n  isLoading: boolean;\r\n}\r\n\r\nexport default function UserInfoForm({ onSubmit, isLoading }: UserInfoProps) {\r\n  const [formData, setFormData] = useState<UserInfo>({\r\n    prolificId: '',\r\n    region: 'North',\r\n    age: 0,\r\n    yearsInRegion: 0\r\n  });\r\n  const [errors, setErrors] = useState<UserInfoErrors>({});\r\n  \r\n  // NEW: State for Prolific ID checking\r\n  const [isCheckingProlificId, setIsCheckingProlificId] = useState(false);\r\n  const [prolificIdExists, setProlificIdExists] = useState(false);\r\n  const [prolificIdCheckComplete, setProlificIdCheckComplete] = useState(false);\r\n\r\n  // Real-time Prolific ID validation\r\n  const validateProlificId = (id: string): string => {\r\n    if (!id) {\r\n      return 'Prolific ID is required';\r\n    }\r\n    if (id.length !== 24) {\r\n      return `Prolific ID must be exactly 24 characters (current: ${id.length})`;\r\n    }\r\n    if (!/^[a-zA-Z0-9]+$/.test(id)) {\r\n      return 'Prolific ID can only contain letters and numbers (no symbols or spaces)';\r\n    }\r\n    return '';\r\n  };\r\n\r\n  // NEW: Debounced function to check if Prolific ID exists\r\n  const checkProlificIdDebounced = useCallback(\r\n    debounce(async (id: string) => {\r\n      if (id.length === 24 && /^[a-zA-Z0-9]+$/.test(id)) {\r\n        setIsCheckingProlificId(true);\r\n        try {\r\n          const exists = await checkProlificIdExists(id);\r\n          setProlificIdExists(exists);\r\n          setProlificIdCheckComplete(true);\r\n          \r\n          if (exists) {\r\n            setErrors(prev => ({ \r\n              ...prev, \r\n              prolificId: 'This Prolific ID has already been used. Please check your ID or contact support if you believe this is an error.' \r\n            }));\r\n          } else {\r\n            // Clear any existing error if the ID is available\r\n            setErrors(prev => {\r\n              const newErrors = { ...prev };\r\n              if (newErrors.prolificId?.includes('already been used')) {\r\n                delete newErrors.prolificId;\r\n              }\r\n              return newErrors;\r\n            });\r\n          }\r\n        } catch (error) {\r\n          console.error('Error checking Prolific ID:', error);\r\n          // On error, we don't block the user but log the issue\r\n          setProlificIdExists(false);\r\n          setProlificIdCheckComplete(true);\r\n        } finally {\r\n          setIsCheckingProlificId(false);\r\n        }\r\n      } else {\r\n        setProlificIdCheckComplete(false);\r\n        setProlificIdExists(false);\r\n      }\r\n    }, 800), // 800ms delay\r\n    []\r\n  );\r\n\r\n  // NEW: Effect to check Prolific ID when it changes\r\n  useEffect(() => {\r\n    if (formData.prolificId) {\r\n      setProlificIdCheckComplete(false);\r\n      checkProlificIdDebounced(formData.prolificId);\r\n    } else {\r\n      setProlificIdCheckComplete(false);\r\n      setProlificIdExists(false);\r\n    }\r\n  }, [formData.prolificId, checkProlificIdDebounced]);\r\n\r\n  const validateForm = (): boolean => {\r\n    const newErrors: UserInfoErrors = {};\r\n\r\n    // Validate Prolific ID\r\n    const prolificError = validateProlificId(formData.prolificId);\r\n    if (prolificError) {\r\n      newErrors.prolificId = prolificError;\r\n    } else if (prolificIdExists) {\r\n      newErrors.prolificId = 'This Prolific ID has already been used. Please check your ID or contact support if you believe this is an error.';\r\n    }\r\n\r\n    if (!formData.region) {\r\n      newErrors.region = 'Please select your region';\r\n    }\r\n\r\n    if (!formData.age || formData.age < 18 || formData.age > 100) {\r\n      newErrors.age = 'Please enter a valid age (18-100)';\r\n    }\r\n\r\n    if (formData.yearsInRegion < 0 || formData.yearsInRegion > formData.age) {\r\n      newErrors.yearsInRegion = 'Years in region cannot exceed your age';\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (validateForm() && !prolificIdExists) {\r\n      onSubmit(formData);\r\n    }\r\n  };\r\n\r\n  const handleRegionChange = (region: keyof typeof REGIONS) => {\r\n    setFormData(prev => ({ ...prev, region }));\r\n    if (errors.region) {\r\n      setErrors(prev => ({ ...prev, region: undefined }));\r\n    }\r\n  };\r\n\r\n  const handleProlificIdChange = (value: string) => {\r\n    // Remove any non-alphanumeric characters and limit to 24\r\n    const cleanValue = value.replace(/[^a-zA-Z0-9]/g, '').slice(0, 24);\r\n    setFormData(prev => ({ ...prev, prolificId: cleanValue }));\r\n    \r\n    // Clear format validation errors when user starts typing\r\n    if (errors.prolificId && !errors.prolificId.includes('already been used')) {\r\n      setErrors(prev => ({ ...prev, prolificId: undefined }));\r\n    }\r\n  };\r\n\r\n  // UPDATED: Check if form is valid (now includes Prolific ID existence check)\r\n  const isFormValid = Object.keys(errors).length === 0 && \r\n                     formData.prolificId.length === 24 && \r\n                     formData.region && \r\n                     formData.age && \r\n                     formData.yearsInRegion >= 0 &&\r\n                     !prolificIdExists &&\r\n                     prolificIdCheckComplete; // Must have completed the check\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-custom-cream flex items-center justify-center p-4\">\r\n      <div className=\"max-w-2xl mx-auto bg-white rounded-2xl shadow-xl p-8 md:p-12 animate-fade-in\">\r\n        <div className=\"text-center mb-8\">\r\n          <h1 className=\"text-3xl md:text-4xl font-bold text-custom-dark-brown mb-4\">\r\n            Tell us about yourself\r\n          </h1>\r\n          <p className=\"text-custom-olive\">\r\n            This information helps us understand the regional context of your responses\r\n          </p>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-8\">\r\n          {/* Prolific ID - TOP PRIORITY */}\r\n          <div>\r\n            <label className=\"block text-lg font-semibold text-custom-dark-brown mb-2\">\r\n              Prolific ID <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <p className=\"text-sm text-custom-olive mb-4\">\r\n              Enter your Prolific participant ID \r\n            </p>\r\n            <div className=\"relative\">\r\n              <input\r\n                type=\"text\"\r\n                value={formData.prolificId}\r\n                onChange={(e) => handleProlificIdChange(e.target.value)}\r\n                placeholder=\"e.g., 507f1f77bcf86cd799439011\"\r\n                className={`w-full px-4 py-3 text-lg rounded-lg border-2 transition-all duration-200 font-mono pr-12\r\n                  ${errors.prolificId \r\n                    ? 'border-red-500 focus:ring-red-500 focus:border-red-500' \r\n                    : formData.prolificId.length === 24 && prolificIdCheckComplete && !prolificIdExists\r\n                      ? 'border-green-500 focus:ring-green-500 focus:border-green-500'\r\n                      : 'border-custom-blue-gray focus:ring-custom-olive focus:border-custom-olive'\r\n                  } focus:ring-2`}\r\n                maxLength={24}\r\n                autoComplete=\"off\"\r\n                style={{\r\n                  color: 'var(--color-dark-brown)'\r\n                }}\r\n              />\r\n              \r\n              {/* NEW: Status indicator */}\r\n              <div className=\"absolute inset-y-0 right-0 pr-3 flex items-center\">\r\n                {isCheckingProlificId ? (\r\n                  <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-custom-olive\"></div>\r\n                ) : formData.prolificId.length === 24 && prolificIdCheckComplete ? (\r\n                  prolificIdExists ? (\r\n                    <span className=\"text-red-500 text-xl\">❌</span>\r\n                  ) : (\r\n                    <span className=\"text-green-500 text-xl\">✅</span>\r\n                  )\r\n                ) : null}\r\n              </div>\r\n            </div>\r\n            \r\n            {/* NEW: Status messages */}\r\n            {isCheckingProlificId && formData.prolificId.length === 24 && (\r\n              <p className=\"text-custom-olive text-sm mt-2 flex items-center\">\r\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-custom-olive mr-2\"></div>\r\n                Checking ID availability...\r\n              </p>\r\n            )}\r\n            \r\n            {prolificIdCheckComplete && formData.prolificId.length === 24 && !prolificIdExists && !errors.prolificId && (\r\n              <p className=\"text-green-600 text-sm mt-2 flex items-center\">\r\n                ✅ Prolific ID is available\r\n              </p>\r\n            )}\r\n            \r\n            {errors.prolificId && (\r\n              <p className=\"text-red-600 text-sm mt-2 flex items-center\">\r\n                ⚠️ {errors.prolificId}\r\n              </p>\r\n            )}\r\n            \r\n          </div>\r\n\r\n          {/* Region Selection */}\r\n          <div>\r\n            <label className=\"block text-lg font-semibold text-custom-dark-brown mb-4\">\r\n              Which region of India are you from? *\r\n            </label>\r\n            <div className=\"space-y-4\">\r\n              {Object.entries(REGIONS).map(([region, states]) => (\r\n                <div key={region} className=\"relative\">\r\n                  <label className=\"flex items-start space-x-3 cursor-pointer p-4 border-2 border-custom-blue-gray rounded-lg hover:bg-custom-blue-gray hover:bg-opacity-30 transition-colors\">\r\n                    <input\r\n                      type=\"radio\"\r\n                      name=\"region\"\r\n                      value={region}\r\n                      checked={formData.region === region}\r\n                      onChange={() => handleRegionChange(region as keyof typeof REGIONS)}\r\n                      className=\"mt-1 h-4 w-4 text-custom-olive focus:ring-custom-olive border-custom-olive\"\r\n                      style={{\r\n                        accentColor: 'var(--color-olive)'\r\n                      }}\r\n                    />\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"font-medium text-custom-dark-brown\">{region} India</div>\r\n                      <div className=\"text-sm text-custom-olive mt-1\">\r\n                        {states.join(', ')}\r\n                      </div>\r\n                    </div>\r\n                  </label>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            {errors.region && (\r\n              <p className=\"mt-2 text-sm text-red-600\">{errors.region}</p>\r\n            )}\r\n          </div>\r\n\r\n          {/* Age Input */}\r\n          <div>\r\n            <label htmlFor=\"age\" className=\"block text-lg font-semibold text-custom-dark-brown mb-2\">\r\n              What is your age? *\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              id=\"age\"\r\n              min=\"18\"\r\n              max=\"100\"\r\n              value={formData.age || ''}\r\n              onChange={(e) => {\r\n                const newAge = parseInt(e.target.value) || 0;\r\n                setFormData(prev => ({ ...prev, age: newAge }));\r\n                if (errors.age) {\r\n                  setErrors(prev => ({ ...prev, age: undefined }));\r\n                }\r\n              }}\r\n              className=\"w-full px-4 py-3 border-2 border-custom-blue-gray rounded-lg focus:ring-2 focus:ring-custom-olive focus:border-custom-olive text-lg text-custom-dark-brown placeholder-custom-olive placeholder-opacity-60\"\r\n              placeholder=\"Enter your age\"\r\n            />\r\n            {errors.age && (\r\n              <p className=\"mt-2 text-sm text-red-600\">{errors.age}</p>\r\n            )}\r\n          </div>\r\n\r\n          {/* Years in Region Input */}\r\n          <div>\r\n            <label htmlFor=\"yearsInRegion\" className=\"block text-lg font-semibold text-custom-dark-brown mb-2\">\r\n              How many years have you lived in this region? *\r\n            </label>\r\n            <input\r\n              type=\"number\"\r\n              id=\"yearsInRegion\"\r\n              min=\"0\"\r\n              max={formData.age || 100}\r\n              value={formData.yearsInRegion || ''}\r\n              onChange={(e) => {\r\n                const newYears = parseInt(e.target.value) || 0;\r\n                setFormData(prev => ({ ...prev, yearsInRegion: newYears }));\r\n                if (errors.yearsInRegion) {\r\n                  setErrors(prev => ({ ...prev, yearsInRegion: undefined }));\r\n                }\r\n              }}\r\n              className=\"w-full px-4 py-3 border-2 border-custom-blue-gray rounded-lg focus:ring-2 focus:ring-custom-olive focus:border-custom-olive text-lg text-custom-dark-brown placeholder-custom-olive placeholder-opacity-60\"\r\n              placeholder=\"Enter number of years\"\r\n            />\r\n            {errors.yearsInRegion && (\r\n              <p className=\"mt-2 text-sm text-red-600\">{errors.yearsInRegion}</p>\r\n            )}\r\n            <p className=\"mt-2 text-sm text-custom-olive\">\r\n              This includes childhood and any time spent living in this region\r\n            </p>\r\n          </div>\r\n\r\n          <div className=\"pt-6\">\r\n            <button\r\n              type=\"submit\"\r\n              disabled={isLoading || !isFormValid || isCheckingProlificId}\r\n              className={`w-full font-bold py-4 px-6 rounded-xl text-lg transition-all duration-200 shadow-lg hover:shadow-xl ${\r\n                isFormValid && !isLoading && !isCheckingProlificId\r\n                  ? 'text-white transform hover:scale-105'\r\n                  : 'text-gray-500 bg-gray-300 cursor-not-allowed'\r\n              }`}\r\n              style={{\r\n                background: isLoading || !isFormValid || isCheckingProlificId\r\n                  ? '#d1d5db'\r\n                  : 'var(--btn-primary-bg)',\r\n                backgroundImage: isLoading || !isFormValid || isCheckingProlificId\r\n                  ? 'none'\r\n                  : 'var(--btn-primary-bg)'\r\n              }}\r\n              onMouseEnter={(e) => {\r\n                if (!isLoading && isFormValid && !isCheckingProlificId) {\r\n                  e.currentTarget.style.backgroundImage = 'var(--btn-primary-hover)';\r\n                }\r\n              }}\r\n              onMouseLeave={(e) => {\r\n                if (!isLoading && isFormValid && !isCheckingProlificId) {\r\n                  e.currentTarget.style.backgroundImage = 'var(--btn-primary-bg)';\r\n                }\r\n              }}\r\n            >\r\n              {isLoading ? (\r\n                <div className=\"flex items-center justify-center\">\r\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-white mr-2\"></div>\r\n                  Creating your session...\r\n                </div>\r\n              ) : isCheckingProlificId ? (\r\n                <div className=\"flex items-center justify-center\">\r\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-400 mr-2\"></div>\r\n                  Checking ID...\r\n                </div>\r\n              ) : (\r\n                'Start Survey'\r\n              )}\r\n            </button>\r\n            \r\n            {/* NEW: Helpful message when button is disabled due to duplicate ID */}\r\n            {prolificIdExists && formData.prolificId.length === 24 && (\r\n              <p className=\"text-center text-sm text-red-600 mt-3\">\r\n                Cannot proceed - this Prolific ID has already been used\r\n              </p>\r\n            )}\r\n          </div>\r\n        </form>\r\n\r\n        <div className=\"mt-6 text-center text-sm text-custom-olive\">\r\n          <p>All information is kept confidential and used only for research purposes.</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// NEW: Debounce utility function\r\nfunction debounce<T extends (...args: any[]) => any>(\r\n  func: T,\r\n  wait: number\r\n): (...args: Parameters<T>) => void {\r\n  let timeout: ReturnType<typeof setTimeout>;\r\n  \r\n  return (...args: Parameters<T>) => {\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(() => func.apply(null, args), wait);\r\n  };\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}