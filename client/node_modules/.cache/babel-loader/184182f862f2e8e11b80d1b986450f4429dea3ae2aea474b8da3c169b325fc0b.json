{"ast":null,"code":"import _objectSpread from\"C:/Users/sangm/OneDrive - Brock University/CommonsenseForm/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{useForm}from'../context/FormContext.tsx';import{validateAnswer,shouldShowAttentionCheck,generateAttentionCheck,analyzeResponseQuality,analyzeUserPattern}from'../utils/helpers.ts';import ProgressBar from'./ProgressBar.tsx';import NavigationMenu from'./NavigationMenu.tsx';import QualityWarningModal from'./QualityWarningModel.tsx';import SurveyTimer from'./SurveyTimer.tsx';import TimeWarningModal from'./TimeWarningModal.tsx';import*as api from'../services/api.ts';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function QuestionForm(){const{state,saveResponse,navigateToNext,navigateToPrevious,getCurrentQuestionData,getTotalQuestionsInCurrentTopic,getCompletedQuestionsInCurrentTopic,resetSession,navigateToPosition}=useForm();// Basic form state\nconst[answer,setAnswer]=useState('');const[errors,setErrors]=useState({});const[isSaving,setIsSaving]=useState(false);const[startTime,setStartTime]=useState(Date.now());const[showSuccess,setShowSuccess]=useState(false);const[lastQuestionId,setLastQuestionId]=useState(null);const[isNavigating,setIsNavigating]=useState(false);const[navigationDirection,setNavigationDirection]=useState(null);const[showNavigationMenu,setShowNavigationMenu]=useState(false);// Time warning modal state\nconst[showTimeWarningModal,setShowTimeWarningModal]=useState(false);const[hasShownTimeWarning,setHasShownTimeWarning]=useState(false);const[hasShownTimeCritical,setHasShownTimeCritical]=useState(false);// Attention check state\nconst[isAttentionCheck,setIsAttentionCheck]=useState(false);const[attentionCheck,setAttentionCheck]=useState(null);const[lastAttentionCheckAt,setLastAttentionCheckAt]=useState(-1);const[attentionChecksPassed,setAttentionChecksPassed]=useState(0);const[attentionChecksFailed,setAttentionChecksFailed]=useState(0);// Quality tracking state\nconst[showQualityModal,setShowQualityModal]=useState(false);const[qualityWarnings,setQualityWarnings]=useState([]);const[lastQualityAlertAt,setLastQualityAlertAt]=useState(-1);const[hasShownQualityAlert,setHasShownQualityAlert]=useState(false);const[currentQualityIssue,setCurrentQualityIssue]=useState({type:null,noneRate:0,gibberishRate:0,speedRate:0});// Celebration state\nconst[showCelebration,setShowCelebration]=useState(null);const textareaRef=useRef(null);const currentQuestionData=getCurrentQuestionData();// Handle time warning modals\nuseEffect(()=>{if(state.showTimeWarning&&!hasShownTimeWarning){setShowTimeWarningModal(true);setHasShownTimeWarning(true);}else if(state.showTimeCritical&&!hasShownTimeCritical){setShowTimeWarningModal(true);setHasShownTimeCritical(true);}// Reset warning flags when time status changes\nif(!state.showTimeWarning&&!state.showTimeCritical){setHasShownTimeWarning(false);setHasShownTimeCritical(false);}},[state.showTimeWarning,state.showTimeCritical,hasShownTimeWarning,hasShownTimeCritical]);// Check if this should be an attention check (every 7 questions)\nuseEffect(()=>{const totalResponses=state.responses.size;console.log('Attention check logic:',{totalResponses,lastAttentionCheckAt,shouldShow:shouldShowAttentionCheck(totalResponses),currentQuestionId:currentQuestionData===null||currentQuestionData===void 0?void 0:currentQuestionData.questionId});// Don't show if we haven't moved to a new response count\nif(lastAttentionCheckAt===totalResponses){console.log('Already shown attention check for this response count');return;}if(shouldShowAttentionCheck(totalResponses)&&currentQuestionData){console.log('SHOWING ATTENTION CHECK at response count:',totalResponses);const check=generateAttentionCheck(currentQuestionData.category,currentQuestionData.topic,state.userInfo||undefined);setAttentionCheck(check);setIsAttentionCheck(true);setLastAttentionCheckAt(totalResponses);setAnswer('');// Clear any existing answer\n}else{// IMPORTANT: Reset attention check state when we shouldn't show one\nconsole.log('NOT showing attention check, resetting state');setIsAttentionCheck(false);setAttentionCheck(null);}},[state.responses.size,lastAttentionCheckAt,currentQuestionData===null||currentQuestionData===void 0?void 0:currentQuestionData.questionId]);// Add a separate effect to handle attention check completion\nuseEffect(()=>{// Reset attention check state when moving to a new question that shouldn't be an attention check\nif(currentQuestionData&&!shouldShowAttentionCheck(state.responses.size)){if(isAttentionCheck){console.log('Resetting attention check state for new question');setIsAttentionCheck(false);setAttentionCheck(null);}}},[currentQuestionData===null||currentQuestionData===void 0?void 0:currentQuestionData.questionId,state.responses.size,isAttentionCheck]);// Reset form when question changes\nuseEffect(()=>{if(currentQuestionData&&currentQuestionData.questionId!==lastQuestionId){console.log('Question changed, loading data for:',currentQuestionData.questionId);setErrors({});setShowSuccess(false);setStartTime(Date.now());setLastQuestionId(currentQuestionData.questionId);setIsNavigating(false);setNavigationDirection(null);setQualityWarnings([]);if(!isAttentionCheck){const existingResponse=state.responses.get(currentQuestionData.questionId);if(existingResponse){console.log('Found existing response:',existingResponse);setAnswer(existingResponse.answer);}else{console.log('No existing response, clearing form');setAnswer('');}}else{setAnswer('');}}},[currentQuestionData===null||currentQuestionData===void 0?void 0:currentQuestionData.questionId,lastQuestionId,state.responses,isAttentionCheck]);// Quality check logic (skip for attention checks)\nuseEffect(()=>{const totalResponses=state.responses.size;if(totalResponses<5||showQualityModal||isAttentionCheck)return;const allResponses=Array.from(state.responses.values());const analysisData=allResponses.map(r=>({answer:r.answer,timeSpent:r.timeSpent}));const patternAnalysis=analyzeUserPattern(analysisData);if(patternAnalysis.suspiciousPattern&&!hasShownQualityAlert){console.log('SHOWING QUALITY ALERT: First detection at',totalResponses);setShowQualityModal(true);setLastQualityAlertAt(totalResponses);setHasShownQualityAlert(true);setQualityWarnings(patternAnalysis.warnings);setCurrentQualityIssue({type:patternAnalysis.issueType,noneRate:patternAnalysis.noneResponseRate,gibberishRate:patternAnalysis.gibberishResponseRate,speedRate:patternAnalysis.fastResponseRate});}else if(patternAnalysis.suspiciousPattern&&hasShownQualityAlert&&lastQualityAlertAt>0&&totalResponses-lastQualityAlertAt>=5){console.log('SHOWING QUALITY ALERT: Persistent issue after 5 responses');setShowQualityModal(true);setLastQualityAlertAt(totalResponses);setQualityWarnings(patternAnalysis.warnings);setCurrentQualityIssue({type:patternAnalysis.issueType,noneRate:patternAnalysis.noneResponseRate,gibberishRate:patternAnalysis.gibberishResponseRate,speedRate:patternAnalysis.fastResponseRate});}},[state.responses.size,showQualityModal,hasShownQualityAlert,lastQualityAlertAt,isAttentionCheck]);// Auto-resize textarea\nuseEffect(()=>{if(textareaRef.current){textareaRef.current.style.height='auto';textareaRef.current.style.height=textareaRef.current.scrollHeight+'px';}},[answer]);const validateForm=()=>{const newErrors={};const answerValidation=validateAnswer(answer);if(!answerValidation.isValid){newErrors.answer=answerValidation.message;}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleAnswerChange=e=>{const newValue=e.target.value;setAnswer(newValue);if(errors.answer){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{answer:undefined}));}// Real-time quality feedback for current response only (skip for attention checks)\nif(newValue.length>5&&!isAttentionCheck){const qualityAnalysis=analyzeResponseQuality(newValue);if(qualityAnalysis.isLowQuality){setQualityWarnings(qualityAnalysis.issues);}else{setQualityWarnings([]);}}else{setQualityWarnings([]);}};const handleClear=()=>{setAnswer('');setErrors({});setShowSuccess(false);setQualityWarnings([]);if(textareaRef.current){textareaRef.current.focus();}};const checkForMilestones=()=>{const{categoryIndex,subcategoryIndex,topicIndex,questionIndex}=state.currentPosition;const currentCategory=state.questionsData[categoryIndex];const currentSubcategory=currentCategory===null||currentCategory===void 0?void 0:currentCategory.subcategories[subcategoryIndex];const currentTopic=currentSubcategory===null||currentSubcategory===void 0?void 0:currentSubcategory.topics[topicIndex];if(!currentTopic)return null;if(questionIndex===currentTopic.questions.length-1){if(topicIndex===currentSubcategory.topics.length-1){if(subcategoryIndex===currentCategory.subcategories.length-1){return{type:'category',name:currentCategory.category,subcategoryName:currentSubcategory.subcategory,topicName:currentTopic.topic};}return{type:'subcategory',name:currentSubcategory.subcategory,topicName:currentTopic.topic,categoryName:currentCategory.category};}return{type:'topic',name:currentTopic.topic,subcategoryName:currentSubcategory.subcategory,categoryName:currentCategory.category};}return null;};const updateAttentionCheckStats=async()=>{if(state.sessionId){try{await api.updateUserProgress(state.sessionId,{attentionChecksPassed,attentionChecksFailed,completedQuestions:state.responses.size});console.log('Updated attention check stats:',{attentionChecksPassed,attentionChecksFailed});}catch(error){console.error('Failed to update attention check stats:',error);}}};// Just save the response, no automatic validation for attention checks\nconst performSave=async qualityAnalysis=>{if(!currentQuestionData||!state.sessionId){console.error('Missing required data for save');return false;}// For attention checks, we'll create a special question ID to identify them\nconst questionId=isAttentionCheck?\"ATTENTION_CHECK_\".concat(state.responses.size,\"_\").concat(currentQuestionData.questionId):currentQuestionData.questionId;const questionText=isAttentionCheck?attentionCheck.question:currentQuestionData.question;if(!qualityAnalysis){qualityAnalysis=analyzeResponseQuality(answer);}setIsSaving(true);try{const timeSpent=Math.floor((Date.now()-startTime)/1000);const response={sessionId:state.sessionId,questionId:questionId,categoryIndex:state.currentPosition.categoryIndex,subcategoryIndex:state.currentPosition.subcategoryIndex,topicIndex:state.currentPosition.topicIndex,questionIndex:state.currentPosition.questionIndex,category:currentQuestionData.category,subcategory:currentQuestionData.subcategory,topic:currentQuestionData.topic,question:questionText,answer:answer.trim(),timeSpent,timestamp:new Date().toISOString(),qualityScore:qualityAnalysis.score,// Add metadata for attention checks\nisAttentionCheck:isAttentionCheck,attentionCheckType:isAttentionCheck?attentionCheck.type:undefined,expectedAnswer:isAttentionCheck?attentionCheck.expectedAnswer:undefined};console.log('Saving response:',{questionId,isAttentionCheck,answer:answer.substring(0,50)+'...',totalResponses:state.responses.size});await saveResponse(response);await updateAttentionCheckStats();// IMPORTANT: Reset attention check state after saving\nif(isAttentionCheck){console.log('Attention check response saved, resetting state');setIsAttentionCheck(false);setAttentionCheck(null);}setShowSuccess(true);setTimeout(()=>setShowSuccess(false),2000);return true;}catch(error){console.error('SAVE ERROR:',error);throw error;}finally{setIsSaving(false);}};const handleSave=async()=>{if(!validateForm()||!currentQuestionData||!state.sessionId){console.log('Validation failed:',errors);return false;}try{const qualityAnalysis=analyzeResponseQuality(answer);return await performSave(qualityAnalysis);}catch(error){console.error('Save failed:',error);alert('Failed to save response. Please try again.');return false;}};const handleNext=async()=>{const isValid=validateForm();if(!isValid){console.log('Form validation failed, cannot proceed');return;}try{const saveSuccessful=await handleSave();if(saveSuccessful&&isValid){const milestone=checkForMilestones();setNavigationDirection('next');setIsNavigating(true);setTimeout(()=>{navigateToNext();if(milestone&&!isAttentionCheck){setShowCelebration({type:milestone.type,data:milestone});}},300);}}catch(error){console.error('Next navigation failed:',error);}};const handlePrevious=()=>{setNavigationDirection('previous');setIsNavigating(true);setTimeout(()=>{navigateToPrevious();},300);};const handleSkip=()=>{if(isAttentionCheck)return;// Don't allow skipping attention checks\nsetAnswer('');setErrors({});setNavigationDirection('next');setIsNavigating(true);setTimeout(()=>{navigateToNext();},300);};const handleNavigateToQuestion=async(categoryIndex,subcategoryIndex,topicIndex,questionIndex)=>{const isValid=validateForm();if(isValid&&answer.trim()){console.log('QuestionForm: Saving current response before navigation');try{await handleSave();}catch(error){console.error('Failed to save before navigation:',error);}}console.log('QuestionForm: Navigating to:',categoryIndex,subcategoryIndex,topicIndex,questionIndex);await navigateToPosition(categoryIndex,subcategoryIndex,topicIndex,questionIndex);};const handleQualityModalClose=()=>{console.log('Quality modal closed - user will improve response');setShowQualityModal(false);setAnswer('');setErrors({});setTimeout(()=>{if(textareaRef.current){textareaRef.current.focus();}},100);};const closeCelebration=()=>{setShowCelebration(null);};if(!currentQuestionData){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Loading question...\"})]})});}// If survey has expired, don't render the question form\nif(state.surveyExpired){return null;// App.tsx will handle showing SurveyExpired component\n}const topicProgress=getTotalQuestionsInCurrentTopic();const completedInTopic=getCompletedQuestionsInCurrentTopic();const currentQuestionInTopic=state.currentPosition.questionIndex+1;const isFirstQuestion=state.currentPosition.categoryIndex===0&&state.currentPosition.subcategoryIndex===0&&state.currentPosition.topicIndex===0&&state.currentPosition.questionIndex===0;const isFormValid=answer.trim().length>=4;// For attention checks, use the attention check question, but make it look like a regular question\nconst displayQuestionData=isAttentionCheck?{topic:currentQuestionData.topic,category:currentQuestionData.category,subcategory:currentQuestionData.subcategory,question:attentionCheck.question}:currentQuestionData;return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen\",style:{background:\"linear-gradient(135deg, var(--bg-primary) 0%, var(--color-cream) 50%, var(--bg-secondary) 100%)\"},children:[/*#__PURE__*/_jsx(SurveyTimer,{}),/*#__PURE__*/_jsx(TimeWarningModal,{isOpen:showTimeWarningModal,onClose:()=>setShowTimeWarningModal(false)}),/*#__PURE__*/_jsx(ProgressBar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-20 right-6 z-40\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowNavigationMenu(true),className:\"p-3 rounded-full shadow-lg transition-all duration-200 hover:scale-110\",style:{background:'var(--btn-primary-bg)',color:'var(--text-on-dark)'},title:\"Navigation Menu\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:\"\\uD83D\\uDCCB\"})})}),/*#__PURE__*/_jsx(NavigationMenu,{isOpen:showNavigationMenu,onClose:()=>setShowNavigationMenu(false),onNavigateTo:handleNavigateToQuestion}),!isAttentionCheck&&/*#__PURE__*/_jsx(QualityWarningModal,{isOpen:showQualityModal,onClose:handleQualityModalClose,qualityIssues:qualityWarnings,issueType:currentQualityIssue.type,noneResponseRate:currentQualityIssue.noneRate,gibberishResponseRate:currentQualityIssue.gibberishRate,fastResponseRate:currentQualityIssue.speedRate}),showCelebration&&/*#__PURE__*/_jsx(CelebrationModal,{celebration:showCelebration,onClose:closeCelebration}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 py-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"relative overflow-hidden\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"transform transition-all duration-500 ease-in-out \".concat(isNavigating?navigationDirection==='next'?'-translate-x-full opacity-0':'translate-x-full opacity-0':'translate-x-0 opacity-100'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"backdrop-blur-sm rounded-2xl shadow-lg p-6 mb-6\",style:{backgroundColor:'var(--bg-card)',border:'1px solid var(--border-light)'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center px-4 py-2 text-white rounded-full text-sm font-medium mb-4 shadow-sm\",style:{background:'var(--btn-primary-bg)'},children:[\"Question \",currentQuestionInTopic,\" of \",topicProgress]}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl md:text-3xl font-semibold mb-3\",style:{color:'var(--text-primary)'},children:displayQuestionData.topic}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full font-medium\",style:{backgroundColor:'var(--tag-category-bg)',color:'var(--tag-category-text)',border:'1px solid var(--border-light)'},children:displayQuestionData.category}),/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--text-muted)'},children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full font-medium\",style:{backgroundColor:'var(--tag-subcategory-bg)',color:'var(--tag-subcategory-text)',border:'1px solid var(--border-light)'},children:displayQuestionData.subcategory})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full rounded-full h-2 overflow-hidden\",style:{backgroundColor:'var(--bg-progress)'},children:/*#__PURE__*/_jsx(\"div\",{className:\"h-2 rounded-full transition-all duration-1000 ease-out\",style:{background:'var(--bg-progress-fill)',width:\"\".concat(completedInTopic/topicProgress*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-sm mt-2\",style:{color:'var(--text-secondary)'},children:[completedInTopic,\" of \",topicProgress,\" questions completed\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"backdrop-blur-sm rounded-2xl shadow-lg overflow-hidden\",style:{backgroundColor:'var(--bg-card)',border:'1px solid var(--border-light)'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",style:{background:'var(--bg-card-header)',color:'var(--text-on-dark)'},children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg md:text-xl font-medium leading-relaxed\",children:displayQuestionData.question})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-base font-medium\",style:{color:'var(--text-primary)'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"Your Answer *\"}),/*#__PURE__*/_jsx(\"span\",{className:\"block text-xs font-normal mt-1\",style:{color:'var(--text-secondary)'},children:\"You can specify \\\"none\\\" if no answer exists\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleClear,className:\"text-sm font-medium hover:underline transition-colors\",style:{color:'var(--accent-warning)'},children:\"Clear Form\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"textarea\",{ref:textareaRef,value:answer,onChange:handleAnswerChange,placeholder:\"Share your knowledge about cultural practices in your region, or specify 'none' if no answer exists...\",className:\"w-full px-4 py-3 border-2 rounded-xl resize-none min-h-[120px] transition-all duration-200 \".concat(errors.answer?'focus:border-red-400':''),style:{color:'var(--text-primary)',borderColor:errors.answer?'var(--accent-error)':'var(--border-medium)',backgroundColor:'rgba(244, 228, 202, 0.3)'},maxLength:5000,disabled:isSaving}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-3 right-3 px-2 py-1 rounded-lg text-xs border\",style:{backgroundColor:answer.length>=4?'var(--color-cream)':'#fef3c7',color:answer.length>=4?'var(--text-secondary)':'var(--accent-warning)',borderColor:answer.length>=4?'var(--border-light)':'#fbbf24'},children:[answer.length,\"/5000 \",answer.length<4&&\"(\".concat(4-answer.length,\" more needed)\")]})]}),errors.answer&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-2 font-medium\",style:{color:'var(--accent-error)'},children:errors.answer})]}),!isAttentionCheck&&qualityWarnings.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 border rounded-xl\",style:{background:'var(--btn-warning-bg)',borderColor:'#fbbf24'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--accent-warning)'},className:\"mr-2\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",style:{color:'#92400e'},children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium mb-1\",children:\"Response Quality Notice:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"text-xs space-y-1\",children:qualityWarnings.map((warning,index)=>/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",warning]},index))}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 font-medium\",children:\"Please provide detailed responses or specify \\\"none\\\" if not applicable.\"})]})]})}),showSuccess&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 border rounded-xl animate-bounce-in\",style:{background:'var(--accent-success)',borderColor:'var(--border-dark)',color:'var(--text-on-dark)'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-2\",children:\"\\u2728\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-sm\",children:\"Response saved successfully!\"})]})}),!isFormValid&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 border rounded-xl\",style:{background:'var(--btn-warning-bg)',borderColor:'#fbbf24'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(\"span\",{style:{color:'var(--accent-warning)'},className:\"mr-2\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm\",style:{color:'#92400e'},children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-medium mb-1\",children:\"Please complete the following:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"text-xs space-y-1\",children:/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Add at least 4 characters to your answer or specify \\\"none\\\"\"})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pt-4 border-t\",style:{borderColor:'var(--border-light)'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handlePrevious,disabled:isFirstQuestion||isNavigating,className:\"flex items-center px-4 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\",style:{background:'var(--btn-warning-bg)',color:'#92400e'},children:[/*#__PURE__*/_jsx(\"span\",{className:\"mr-2\",children:\"\\u2190\"}),\"Previous\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[!isAttentionCheck&&/*#__PURE__*/_jsx(\"button\",{onClick:handleSkip,disabled:isNavigating,className:\"px-4 py-2 font-medium rounded-xl transition-all duration-200 text-sm\",style:{background:'var(--btn-warning-bg)',color:'#92400e'},children:\"Skip\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,disabled:isSaving||!isFormValid||isNavigating,className:\"px-4 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\",style:{background:'var(--btn-secondary-bg)',color:'var(--text-on-dark)'},children:isSaving?'Saving...':'Save'}),/*#__PURE__*/_jsx(\"button\",{onClick:handleNext,disabled:isSaving||!isFormValid||isNavigating,className:\"flex items-center px-5 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\",style:{background:'var(--btn-primary-bg)',color:'var(--text-on-dark)'},children:isNavigating?'Moving...':/*#__PURE__*/_jsxs(_Fragment,{children:[\"Save & Continue\",/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:\"\\u2192\"})]})})]})]})]})]})]})})})]});}// Celebration Modal Component (keep icons only, no emojis)\nfunction CelebrationModal(_ref){let{celebration,onClose}=_ref;const celebrations={topic:{icon:'üéØ',title:'Topic Completed!'},subcategory:{icon:'üèÜ',title:'Subcategory Mastered!'},category:{icon:'üëë',title:'Category Champion!'}};const config=celebrations[celebration.type];return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-2xl p-6 max-w-lg mx-auto text-center shadow-2xl animate-bounce-in\",style:{backgroundColor:'var(--bg-card)',border:'1px solid var(--border-light)'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-5xl mb-3\",children:config.icon}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-3\",style:{color:'var(--text-primary)'},children:config.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 rounded-xl mb-4\",style:{background:'linear-gradient(to right, var(--tag-category-bg), var(--tag-subcategory-bg))',border:'1px solid var(--border-light)'},children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-medium text-lg mb-2\",style:{color:'var(--text-primary)'},children:[\"\\\"\",celebration.data.name,\"\\\"\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm\",style:{color:'var(--text-secondary)'},children:[celebration.type==='topic'&&\"in \".concat(celebration.data.subcategoryName),celebration.type==='subcategory'&&\"from \".concat(celebration.data.categoryName),celebration.type==='category'&&'Entire category completed!']})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"px-6 py-2 font-medium rounded-xl transition-all duration-200\",style:{background:'var(--btn-primary-bg)',color:'var(--text-on-dark)'},children:\"Continue Survey\"})]})});}","map":{"version":3,"names":["React","useState","useEffect","useRef","useForm","validateAnswer","shouldShowAttentionCheck","generateAttentionCheck","analyzeResponseQuality","analyzeUserPattern","ProgressBar","NavigationMenu","QualityWarningModal","SurveyTimer","TimeWarningModal","api","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","QuestionForm","state","saveResponse","navigateToNext","navigateToPrevious","getCurrentQuestionData","getTotalQuestionsInCurrentTopic","getCompletedQuestionsInCurrentTopic","resetSession","navigateToPosition","answer","setAnswer","errors","setErrors","isSaving","setIsSaving","startTime","setStartTime","Date","now","showSuccess","setShowSuccess","lastQuestionId","setLastQuestionId","isNavigating","setIsNavigating","navigationDirection","setNavigationDirection","showNavigationMenu","setShowNavigationMenu","showTimeWarningModal","setShowTimeWarningModal","hasShownTimeWarning","setHasShownTimeWarning","hasShownTimeCritical","setHasShownTimeCritical","isAttentionCheck","setIsAttentionCheck","attentionCheck","setAttentionCheck","lastAttentionCheckAt","setLastAttentionCheckAt","attentionChecksPassed","setAttentionChecksPassed","attentionChecksFailed","setAttentionChecksFailed","showQualityModal","setShowQualityModal","qualityWarnings","setQualityWarnings","lastQualityAlertAt","setLastQualityAlertAt","hasShownQualityAlert","setHasShownQualityAlert","currentQualityIssue","setCurrentQualityIssue","type","noneRate","gibberishRate","speedRate","showCelebration","setShowCelebration","textareaRef","currentQuestionData","showTimeWarning","showTimeCritical","totalResponses","responses","size","console","log","shouldShow","currentQuestionId","questionId","check","category","topic","userInfo","undefined","existingResponse","get","allResponses","Array","from","values","analysisData","map","r","timeSpent","patternAnalysis","suspiciousPattern","warnings","issueType","noneResponseRate","gibberishResponseRate","fastResponseRate","current","style","height","scrollHeight","validateForm","newErrors","answerValidation","isValid","message","Object","keys","length","handleAnswerChange","e","newValue","target","value","prev","_objectSpread","qualityAnalysis","isLowQuality","issues","handleClear","focus","checkForMilestones","categoryIndex","subcategoryIndex","topicIndex","questionIndex","currentPosition","currentCategory","questionsData","currentSubcategory","subcategories","currentTopic","topics","questions","name","subcategoryName","subcategory","topicName","categoryName","updateAttentionCheckStats","sessionId","updateUserProgress","completedQuestions","error","performSave","concat","questionText","question","Math","floor","response","trim","timestamp","toISOString","qualityScore","score","attentionCheckType","expectedAnswer","substring","setTimeout","handleSave","alert","handleNext","saveSuccessful","milestone","data","handlePrevious","handleSkip","handleNavigateToQuestion","handleQualityModalClose","closeCelebration","className","children","surveyExpired","topicProgress","completedInTopic","currentQuestionInTopic","isFirstQuestion","isFormValid","displayQuestionData","background","isOpen","onClose","onClick","color","title","onNavigateTo","qualityIssues","CelebrationModal","celebration","backgroundColor","border","width","ref","onChange","placeholder","borderColor","maxLength","disabled","warning","index","_ref","celebrations","icon","config"],"sources":["C:/Users/sangm/OneDrive - Brock University/CommonsenseForm/client/src/components/QuestionForm.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useForm } from '../context/FormContext.tsx';\r\nimport { validateAnswer, shouldShowAttentionCheck, generateAttentionCheck, analyzeResponseQuality, analyzeUserPattern } from '../utils/helpers.ts';\r\nimport ProgressBar from './ProgressBar.tsx';\r\nimport NavigationMenu from './NavigationMenu.tsx';\r\nimport QualityWarningModal from './QualityWarningModel.tsx';\r\nimport SurveyTimer from './SurveyTimer.tsx';\r\nimport TimeWarningModal from './TimeWarningModal.tsx';\r\nimport * as api from '../services/api.ts';\r\n\r\nexport default function QuestionForm() {\r\n  const {\r\n    state,\r\n    saveResponse,\r\n    navigateToNext,\r\n    navigateToPrevious,\r\n    getCurrentQuestionData,\r\n    getTotalQuestionsInCurrentTopic,\r\n    getCompletedQuestionsInCurrentTopic,\r\n    resetSession,\r\n    navigateToPosition\r\n  } = useForm();\r\n\r\n  // Basic form state\r\n  const [answer, setAnswer] = useState('');\r\n  const [errors, setErrors] = useState<{ answer?: string }>({});\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [startTime, setStartTime] = useState(Date.now());\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n  const [lastQuestionId, setLastQuestionId] = useState<string | null>(null);\r\n  const [isNavigating, setIsNavigating] = useState(false);\r\n  const [navigationDirection, setNavigationDirection] = useState<'next' | 'previous' | null>(null);\r\n  const [showNavigationMenu, setShowNavigationMenu] = useState(false);\r\n\r\n  // Time warning modal state\r\n  const [showTimeWarningModal, setShowTimeWarningModal] = useState(false);\r\n  const [hasShownTimeWarning, setHasShownTimeWarning] = useState(false);\r\n  const [hasShownTimeCritical, setHasShownTimeCritical] = useState(false);\r\n\r\n  // Attention check state\r\n  const [isAttentionCheck, setIsAttentionCheck] = useState(false);\r\n  const [attentionCheck, setAttentionCheck] = useState<any>(null);\r\n  const [lastAttentionCheckAt, setLastAttentionCheckAt] = useState<number>(-1);\r\n  const [attentionChecksPassed, setAttentionChecksPassed] = useState(0);\r\n  const [attentionChecksFailed, setAttentionChecksFailed] = useState(0);\r\n\r\n  // Quality tracking state\r\n  const [showQualityModal, setShowQualityModal] = useState(false);\r\n  const [qualityWarnings, setQualityWarnings] = useState<string[]>([]);\r\n  const [lastQualityAlertAt, setLastQualityAlertAt] = useState<number>(-1);\r\n  const [hasShownQualityAlert, setHasShownQualityAlert] = useState(false);\r\n  const [currentQualityIssue, setCurrentQualityIssue] = useState<{\r\n    type: string | null;\r\n    noneRate: number;\r\n    gibberishRate: number;\r\n    speedRate: number;\r\n  }>({ type: null, noneRate: 0, gibberishRate: 0, speedRate: 0 });\r\n\r\n  // Celebration state\r\n  const [showCelebration, setShowCelebration] = useState<{type: string, data: any} | null>(null);\r\n\r\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\r\n  const currentQuestionData = getCurrentQuestionData();\r\n\r\n  // Handle time warning modals\r\n  useEffect(() => {\r\n    if (state.showTimeWarning && !hasShownTimeWarning) {\r\n      setShowTimeWarningModal(true);\r\n      setHasShownTimeWarning(true);\r\n    } else if (state.showTimeCritical && !hasShownTimeCritical) {\r\n      setShowTimeWarningModal(true);\r\n      setHasShownTimeCritical(true);\r\n    }\r\n    \r\n    // Reset warning flags when time status changes\r\n    if (!state.showTimeWarning && !state.showTimeCritical) {\r\n      setHasShownTimeWarning(false);\r\n      setHasShownTimeCritical(false);\r\n    }\r\n  }, [state.showTimeWarning, state.showTimeCritical, hasShownTimeWarning, hasShownTimeCritical]);\r\n\r\n  // Check if this should be an attention check (every 7 questions)\r\nuseEffect(() => {\r\n  const totalResponses = state.responses.size;\r\n  \r\n  console.log('Attention check logic:', {\r\n    totalResponses,\r\n    lastAttentionCheckAt,\r\n    shouldShow: shouldShowAttentionCheck(totalResponses),\r\n    currentQuestionId: currentQuestionData?.questionId\r\n  });\r\n  \r\n  // Don't show if we haven't moved to a new response count\r\n  if (lastAttentionCheckAt === totalResponses) {\r\n    console.log('Already shown attention check for this response count');\r\n    return;\r\n  }\r\n  \r\n  if (shouldShowAttentionCheck(totalResponses) && currentQuestionData) {\r\n    console.log('SHOWING ATTENTION CHECK at response count:', totalResponses);\r\n    \r\n    const check = generateAttentionCheck(\r\n      currentQuestionData.category,\r\n      currentQuestionData.topic,\r\n      state.userInfo || undefined\r\n    );\r\n    \r\n    setAttentionCheck(check);\r\n    setIsAttentionCheck(true);\r\n    setLastAttentionCheckAt(totalResponses);\r\n    setAnswer(''); // Clear any existing answer\r\n  } else {\r\n    // IMPORTANT: Reset attention check state when we shouldn't show one\r\n    console.log('NOT showing attention check, resetting state');\r\n    setIsAttentionCheck(false);\r\n    setAttentionCheck(null);\r\n  }\r\n}, [state.responses.size, lastAttentionCheckAt, currentQuestionData?.questionId]);\r\n\r\n\r\n// Add a separate effect to handle attention check completion\r\nuseEffect(() => {\r\n  // Reset attention check state when moving to a new question that shouldn't be an attention check\r\n  if (currentQuestionData && !shouldShowAttentionCheck(state.responses.size)) {\r\n    if (isAttentionCheck) {\r\n      console.log('Resetting attention check state for new question');\r\n      setIsAttentionCheck(false);\r\n      setAttentionCheck(null);\r\n    }\r\n  }\r\n}, [currentQuestionData?.questionId, state.responses.size, isAttentionCheck]);\r\n\r\n  // Reset form when question changes\r\n  useEffect(() => {\r\n    if (currentQuestionData && currentQuestionData.questionId !== lastQuestionId) {\r\n      console.log('Question changed, loading data for:', currentQuestionData.questionId);\r\n      \r\n      setErrors({});\r\n      setShowSuccess(false);\r\n      setStartTime(Date.now());\r\n      setLastQuestionId(currentQuestionData.questionId);\r\n      setIsNavigating(false);\r\n      setNavigationDirection(null);\r\n      setQualityWarnings([]);\r\n      \r\n      if (!isAttentionCheck) {\r\n        const existingResponse = state.responses.get(currentQuestionData.questionId);\r\n        if (existingResponse) {\r\n          console.log('Found existing response:', existingResponse);\r\n          setAnswer(existingResponse.answer);\r\n        } else {\r\n          console.log('No existing response, clearing form');\r\n          setAnswer('');\r\n        }\r\n      } else {\r\n        setAnswer('');\r\n      }\r\n    }\r\n  }, [currentQuestionData?.questionId, lastQuestionId, state.responses, isAttentionCheck]);\r\n\r\n  // Quality check logic (skip for attention checks)\r\n  useEffect(() => {\r\n    const totalResponses = state.responses.size;\r\n    \r\n    if (totalResponses < 5 || showQualityModal || isAttentionCheck) return;\r\n\r\n    const allResponses = Array.from(state.responses.values());\r\n    const analysisData = allResponses.map(r => ({ answer: r.answer, timeSpent: r.timeSpent }));\r\n    const patternAnalysis = analyzeUserPattern(analysisData);\r\n    \r\n    if (patternAnalysis.suspiciousPattern && !hasShownQualityAlert) {\r\n      console.log('SHOWING QUALITY ALERT: First detection at', totalResponses);\r\n      setShowQualityModal(true);\r\n      setLastQualityAlertAt(totalResponses);\r\n      setHasShownQualityAlert(true);\r\n      setQualityWarnings(patternAnalysis.warnings);\r\n      setCurrentQualityIssue({\r\n        type: patternAnalysis.issueType,\r\n        noneRate: patternAnalysis.noneResponseRate,\r\n        gibberishRate: patternAnalysis.gibberishResponseRate,\r\n        speedRate: patternAnalysis.fastResponseRate\r\n      });\r\n    }\r\n    else if (patternAnalysis.suspiciousPattern && \r\n             hasShownQualityAlert && \r\n             lastQualityAlertAt > 0 && \r\n             (totalResponses - lastQualityAlertAt) >= 5) {\r\n      console.log('SHOWING QUALITY ALERT: Persistent issue after 5 responses');\r\n      setShowQualityModal(true);\r\n      setLastQualityAlertAt(totalResponses);\r\n      setQualityWarnings(patternAnalysis.warnings);\r\n      setCurrentQualityIssue({\r\n        type: patternAnalysis.issueType,\r\n        noneRate: patternAnalysis.noneResponseRate,\r\n        gibberishRate: patternAnalysis.gibberishResponseRate,\r\n        speedRate: patternAnalysis.fastResponseRate\r\n      });\r\n    }\r\n  }, [state.responses.size, showQualityModal, hasShownQualityAlert, lastQualityAlertAt, isAttentionCheck]);\r\n\r\n  // Auto-resize textarea\r\n  useEffect(() => {\r\n    if (textareaRef.current) {\r\n      textareaRef.current.style.height = 'auto';\r\n      textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\r\n    }\r\n  }, [answer]);\r\n\r\n  const validateForm = () => {\r\n    const newErrors: { answer?: string } = {};\r\n    \r\n    const answerValidation = validateAnswer(answer);\r\n    if (!answerValidation.isValid) {\r\n      newErrors.answer = answerValidation.message;\r\n    }\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleAnswerChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    const newValue = e.target.value;\r\n    setAnswer(newValue);\r\n    \r\n    if (errors.answer) {\r\n      setErrors(prev => ({ ...prev, answer: undefined }));\r\n    }\r\n\r\n    // Real-time quality feedback for current response only (skip for attention checks)\r\n    if (newValue.length > 5 && !isAttentionCheck) {\r\n      const qualityAnalysis = analyzeResponseQuality(newValue);\r\n      if (qualityAnalysis.isLowQuality) {\r\n        setQualityWarnings(qualityAnalysis.issues);\r\n      } else {\r\n        setQualityWarnings([]);\r\n      }\r\n    } else {\r\n      setQualityWarnings([]);\r\n    }\r\n  };\r\n\r\n  const handleClear = () => {\r\n    setAnswer('');\r\n    setErrors({});\r\n    setShowSuccess(false);\r\n    setQualityWarnings([]);\r\n    if (textareaRef.current) {\r\n      textareaRef.current.focus();\r\n    }\r\n  };\r\n\r\n  const checkForMilestones = () => {\r\n    const { categoryIndex, subcategoryIndex, topicIndex, questionIndex } = state.currentPosition;\r\n    const currentCategory = state.questionsData[categoryIndex];\r\n    const currentSubcategory = currentCategory?.subcategories[subcategoryIndex];\r\n    const currentTopic = currentSubcategory?.topics[topicIndex];\r\n    \r\n    if (!currentTopic) return null;\r\n\r\n    if (questionIndex === currentTopic.questions.length - 1) {\r\n      if (topicIndex === currentSubcategory.topics.length - 1) {\r\n        if (subcategoryIndex === currentCategory.subcategories.length - 1) {\r\n          return {\r\n            type: 'category',\r\n            name: currentCategory.category,\r\n            subcategoryName: currentSubcategory.subcategory,\r\n            topicName: currentTopic.topic\r\n          };\r\n        }\r\n        return {\r\n          type: 'subcategory',\r\n          name: currentSubcategory.subcategory,\r\n          topicName: currentTopic.topic,\r\n          categoryName: currentCategory.category\r\n        };\r\n      }\r\n      return {\r\n        type: 'topic',\r\n        name: currentTopic.topic,\r\n        subcategoryName: currentSubcategory.subcategory,\r\n        categoryName: currentCategory.category\r\n      };\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const updateAttentionCheckStats = async () => {\r\n    if (state.sessionId) {\r\n      try {\r\n        await api.updateUserProgress(state.sessionId, {\r\n          attentionChecksPassed,\r\n          attentionChecksFailed,\r\n          completedQuestions: state.responses.size\r\n        });\r\n        console.log('Updated attention check stats:', { attentionChecksPassed, attentionChecksFailed });\r\n      } catch (error) {\r\n        console.error('Failed to update attention check stats:', error);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Just save the response, no automatic validation for attention checks\r\n  const performSave = async (qualityAnalysis?: any) => {\r\n  if (!currentQuestionData || !state.sessionId) {\r\n    console.error('Missing required data for save');\r\n    return false;\r\n  }\r\n\r\n  // For attention checks, we'll create a special question ID to identify them\r\n  const questionId = isAttentionCheck \r\n    ? `ATTENTION_CHECK_${state.responses.size}_${currentQuestionData.questionId}`\r\n    : currentQuestionData.questionId;\r\n\r\n  const questionText = isAttentionCheck \r\n    ? attentionCheck.question \r\n    : currentQuestionData.question;\r\n\r\n  if (!qualityAnalysis) {\r\n    qualityAnalysis = analyzeResponseQuality(answer);\r\n  }\r\n\r\n  setIsSaving(true);\r\n  \r\n  try {\r\n    const timeSpent = Math.floor((Date.now() - startTime) / 1000);\r\n    \r\n    const response = {\r\n      sessionId: state.sessionId,\r\n      questionId: questionId,\r\n      categoryIndex: state.currentPosition.categoryIndex,\r\n      subcategoryIndex: state.currentPosition.subcategoryIndex,\r\n      topicIndex: state.currentPosition.topicIndex,\r\n      questionIndex: state.currentPosition.questionIndex,\r\n      category: currentQuestionData.category,\r\n      subcategory: currentQuestionData.subcategory,\r\n      topic: currentQuestionData.topic,\r\n      question: questionText,\r\n      answer: answer.trim(),\r\n      timeSpent,\r\n      timestamp: new Date().toISOString(),\r\n      qualityScore: qualityAnalysis.score,\r\n      // Add metadata for attention checks\r\n      isAttentionCheck: isAttentionCheck,\r\n      attentionCheckType: isAttentionCheck ? attentionCheck.type : undefined,\r\n      expectedAnswer: isAttentionCheck ? attentionCheck.expectedAnswer : undefined\r\n    };\r\n\r\n    console.log('Saving response:', {\r\n      questionId,\r\n      isAttentionCheck,\r\n      answer: answer.substring(0, 50) + '...',\r\n      totalResponses: state.responses.size\r\n    });\r\n\r\n    await saveResponse(response);\r\n    await updateAttentionCheckStats();\r\n    \r\n    // IMPORTANT: Reset attention check state after saving\r\n    if (isAttentionCheck) {\r\n      console.log('Attention check response saved, resetting state');\r\n      setIsAttentionCheck(false);\r\n      setAttentionCheck(null);\r\n    }\r\n    \r\n    setShowSuccess(true);\r\n    setTimeout(() => setShowSuccess(false), 2000);\r\n    return true;\r\n    \r\n  } catch (error) {\r\n    console.error('SAVE ERROR:', error);\r\n    throw error;\r\n  } finally {\r\n    setIsSaving(false);\r\n  }\r\n};\r\n\r\n\r\n\r\n  const handleSave = async () => {\r\n    if (!validateForm() || !currentQuestionData || !state.sessionId) {\r\n      console.log('Validation failed:', errors);\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const qualityAnalysis = analyzeResponseQuality(answer);\r\n      return await performSave(qualityAnalysis);\r\n    } catch (error) {\r\n      console.error('Save failed:', error);\r\n      alert('Failed to save response. Please try again.');\r\n      return false;\r\n    }\r\n  };\r\n\r\n  const handleNext = async () => {\r\n    const isValid = validateForm();\r\n    if (!isValid) {\r\n      console.log('Form validation failed, cannot proceed');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const saveSuccessful = await handleSave();\r\n      \r\n      if (saveSuccessful && isValid) {\r\n        const milestone = checkForMilestones();\r\n        \r\n        setNavigationDirection('next');\r\n        setIsNavigating(true);\r\n        \r\n        setTimeout(() => {\r\n          navigateToNext();\r\n          \r\n          if (milestone && !isAttentionCheck) {\r\n            setShowCelebration({type: milestone.type, data: milestone});\r\n          }\r\n        }, 300);\r\n      }\r\n    } catch (error) {\r\n      console.error('Next navigation failed:', error);\r\n    }\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    setNavigationDirection('previous');\r\n    setIsNavigating(true);\r\n    \r\n    setTimeout(() => {\r\n      navigateToPrevious();\r\n    }, 300);\r\n  };\r\n\r\n  const handleSkip = () => {\r\n    if (isAttentionCheck) return; // Don't allow skipping attention checks\r\n    \r\n    setAnswer('');\r\n    setErrors({});\r\n    \r\n    setNavigationDirection('next');\r\n    setIsNavigating(true);\r\n    \r\n    setTimeout(() => {\r\n      navigateToNext();\r\n    }, 300);\r\n  };\r\n\r\n  const handleNavigateToQuestion = async (categoryIndex: number, subcategoryIndex: number, topicIndex: number, questionIndex: number) => {\r\n    const isValid = validateForm();\r\n    if (isValid && answer.trim()) {\r\n      console.log('QuestionForm: Saving current response before navigation');\r\n      try {\r\n        await handleSave();\r\n      } catch (error) {\r\n        console.error('Failed to save before navigation:', error);\r\n      }\r\n    }\r\n    \r\n    console.log('QuestionForm: Navigating to:', categoryIndex, subcategoryIndex, topicIndex, questionIndex);\r\n    await navigateToPosition(categoryIndex, subcategoryIndex, topicIndex, questionIndex);\r\n  };\r\n\r\n  const handleQualityModalClose = () => {\r\n    console.log('Quality modal closed - user will improve response');\r\n    setShowQualityModal(false);\r\n    \r\n    setAnswer('');\r\n    setErrors({});\r\n    \r\n    setTimeout(() => {\r\n      if (textareaRef.current) {\r\n        textareaRef.current.focus();\r\n      }\r\n    }, 100);\r\n  };\r\n\r\n  const closeCelebration = () => {\r\n    setShowCelebration(null);\r\n  };\r\n\r\n  if (!currentQuestionData) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gray-100 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">Loading question...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // If survey has expired, don't render the question form\r\n  if (state.surveyExpired) {\r\n    return null; // App.tsx will handle showing SurveyExpired component\r\n  }\r\n\r\n  const topicProgress = getTotalQuestionsInCurrentTopic();\r\n  const completedInTopic = getCompletedQuestionsInCurrentTopic();\r\n  const currentQuestionInTopic = state.currentPosition.questionIndex + 1;\r\n  const isFirstQuestion = state.currentPosition.categoryIndex === 0 && \r\n                         state.currentPosition.subcategoryIndex === 0 && \r\n                         state.currentPosition.topicIndex === 0 && \r\n                         state.currentPosition.questionIndex === 0;\r\n\r\n  const isFormValid = answer.trim().length >= 4;\r\n\r\n  // For attention checks, use the attention check question, but make it look like a regular question\r\n  const displayQuestionData = isAttentionCheck \r\n    ? {\r\n        topic: currentQuestionData.topic,\r\n        category: currentQuestionData.category,\r\n        subcategory: currentQuestionData.subcategory,\r\n        question: attentionCheck.question\r\n      }\r\n    : currentQuestionData;\r\n\r\n  return (\r\n    <div \r\n      className=\"min-h-screen\"\r\n      style={{ \r\n        background: `linear-gradient(135deg, var(--bg-primary) 0%, var(--color-cream) 50%, var(--bg-secondary) 100%)` \r\n      }}\r\n    >\r\n      {/* Timer Components */}\r\n      <SurveyTimer />\r\n      <TimeWarningModal \r\n        isOpen={showTimeWarningModal}\r\n        onClose={() => setShowTimeWarningModal(false)}\r\n      />\r\n      \r\n      <ProgressBar />\r\n      \r\n      {/* Menu Button */}\r\n      <div className=\"fixed top-20 right-6 z-40\">\r\n        <button\r\n          onClick={() => setShowNavigationMenu(true)}\r\n          className=\"p-3 rounded-full shadow-lg transition-all duration-200 hover:scale-110\"\r\n          style={{ \r\n            background: 'var(--btn-primary-bg)',\r\n            color: 'var(--text-on-dark)'\r\n          }}\r\n          title=\"Navigation Menu\"\r\n        >\r\n          <span className=\"text-xl\">üìã</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Navigation Menu */}\r\n      <NavigationMenu \r\n        isOpen={showNavigationMenu}\r\n        onClose={() => setShowNavigationMenu(false)}\r\n        onNavigateTo={handleNavigateToQuestion}\r\n      />\r\n\r\n      {/* Quality Warning Modal (not shown for attention checks) */}\r\n      {!isAttentionCheck && (\r\n        <QualityWarningModal\r\n          isOpen={showQualityModal}\r\n          onClose={handleQualityModalClose}\r\n          qualityIssues={qualityWarnings}\r\n          issueType={currentQualityIssue.type}\r\n          noneResponseRate={currentQualityIssue.noneRate}\r\n          gibberishResponseRate={currentQualityIssue.gibberishRate}\r\n          fastResponseRate={currentQualityIssue.speedRate}\r\n        />\r\n      )}\r\n      \r\n      {/* Celebration Modal */}\r\n      {showCelebration && (\r\n        <CelebrationModal \r\n          celebration={showCelebration} \r\n          onClose={closeCelebration}\r\n        />\r\n      )}\r\n      \r\n      <div className=\"max-w-4xl mx-auto px-4 py-6\">\r\n        {/* Question Card Container */}\r\n        <div className=\"relative overflow-hidden\">\r\n          <div className={`transform transition-all duration-500 ease-in-out ${\r\n            isNavigating \r\n              ? navigationDirection === 'next' \r\n                ? '-translate-x-full opacity-0'\r\n                : 'translate-x-full opacity-0'\r\n              : 'translate-x-0 opacity-100'\r\n          }`}>\r\n            \r\n            {/* Topic Header Card */}\r\n            <div \r\n              className=\"backdrop-blur-sm rounded-2xl shadow-lg p-6 mb-6\"\r\n              style={{ \r\n                backgroundColor: 'var(--bg-card)',\r\n                border: '1px solid var(--border-light)'\r\n              }}\r\n            >\r\n              <div className=\"text-center mb-4\">\r\n                <div \r\n                  className=\"inline-flex items-center px-4 py-2 text-white rounded-full text-sm font-medium mb-4 shadow-sm\"\r\n                  style={{ \r\n                    background: 'var(--btn-primary-bg)' \r\n                  }}\r\n                >\r\n                  Question {currentQuestionInTopic} of {topicProgress}\r\n                </div>\r\n                \r\n                <h1 \r\n                  className=\"text-2xl md:text-3xl font-semibold mb-3\"\r\n                  style={{ color: 'var(--text-primary)' }}\r\n                >\r\n                  {displayQuestionData.topic}\r\n                </h1>\r\n                \r\n                <div className=\"flex items-center justify-center space-x-2 text-sm\">\r\n                  <span \r\n                    className=\"px-3 py-1 rounded-full font-medium\"\r\n                    style={{ \r\n                      backgroundColor: 'var(--tag-category-bg)',\r\n                      color: 'var(--tag-category-text)',\r\n                      border: '1px solid var(--border-light)'\r\n                    }}\r\n                  >\r\n                    {displayQuestionData.category}\r\n                  </span>\r\n                  <span style={{ color: 'var(--text-muted)' }}>‚Ä¢</span>\r\n                  <span \r\n                    className=\"px-3 py-1 rounded-full font-medium\"\r\n                    style={{ \r\n                      backgroundColor: 'var(--tag-subcategory-bg)',\r\n                      color: 'var(--tag-subcategory-text)',\r\n                      border: '1px solid var(--border-light)'\r\n                    }}\r\n                  >\r\n                    {displayQuestionData.subcategory}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Topic Progress Bar */}\r\n              <div className=\"relative\">\r\n                <div \r\n                  className=\"w-full rounded-full h-2 overflow-hidden\"\r\n                  style={{ backgroundColor: 'var(--bg-progress)' }}\r\n                >\r\n                  <div \r\n                    className=\"h-2 rounded-full transition-all duration-1000 ease-out\"\r\n                    style={{ \r\n                      background: 'var(--bg-progress-fill)',\r\n                      width: `${(completedInTopic / topicProgress) * 100}%` \r\n                    }}\r\n                  ></div>\r\n                </div>\r\n                \r\n                <div \r\n                  className=\"text-center text-sm mt-2\"\r\n                  style={{ color: 'var(--text-secondary)' }}\r\n                >\r\n                  {completedInTopic} of {topicProgress} questions completed\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Main Question Card */}\r\n            <div \r\n              className=\"backdrop-blur-sm rounded-2xl shadow-lg overflow-hidden\"\r\n              style={{ \r\n                backgroundColor: 'var(--bg-card)',\r\n                border: '1px solid var(--border-light)'\r\n              }}\r\n            >\r\n              \r\n              {/* Question Header - looks identical for both regular and attention check questions */}\r\n              <div \r\n                className=\"p-6\"\r\n                style={{ \r\n                  background: 'var(--bg-card-header)',\r\n                  color: 'var(--text-on-dark)'\r\n                }}\r\n              >\r\n                <h2 className=\"text-lg md:text-xl font-medium leading-relaxed\">\r\n                  {displayQuestionData.question}\r\n                </h2>\r\n              </div>\r\n\r\n              {/* Answer Section */}\r\n              <div className=\"p-6\">\r\n                <div className=\"mb-6\">\r\n                  <div className=\"flex justify-between items-center mb-3\">\r\n                    <label \r\n                      className=\"block text-base font-medium\"\r\n                      style={{ color: 'var(--text-primary)' }}\r\n                    >\r\n                      <span>Your Answer *</span>\r\n                      <span \r\n                        className=\"block text-xs font-normal mt-1\"\r\n                        style={{ color: 'var(--text-secondary)' }}\r\n                      >\r\n                        You can specify \"none\" if no answer exists\r\n                      </span>\r\n                    </label>\r\n                    <button\r\n                      onClick={handleClear}\r\n                      className=\"text-sm font-medium hover:underline transition-colors\"\r\n                      style={{ color: 'var(--accent-warning)' }}\r\n                    >\r\n                      Clear Form\r\n                    </button>\r\n                  </div>\r\n                  \r\n                  {/* Regular Question Textarea - same for both regular and attention checks */}\r\n                  <div className=\"relative\">\r\n                    <textarea\r\n                      ref={textareaRef}\r\n                      value={answer}\r\n                      onChange={handleAnswerChange}\r\n                      placeholder=\"Share your knowledge about cultural practices in your region, or specify 'none' if no answer exists...\"\r\n                      className={`w-full px-4 py-3 border-2 rounded-xl resize-none min-h-[120px] transition-all duration-200 ${\r\n                        errors.answer ? 'focus:border-red-400' : ''\r\n                      }`}\r\n                      style={{\r\n                        color: 'var(--text-primary)',\r\n                        borderColor: errors.answer ? 'var(--accent-error)' : 'var(--border-medium)',\r\n                        backgroundColor: 'rgba(244, 228, 202, 0.3)'\r\n                      }}\r\n                      maxLength={5000}\r\n                      disabled={isSaving}\r\n                    />\r\n                    \r\n                    <div \r\n                      className={`absolute bottom-3 right-3 px-2 py-1 rounded-lg text-xs border`}\r\n                      style={{\r\n                        backgroundColor: answer.length >= 4 ? 'var(--color-cream)' : '#fef3c7',\r\n                        color: answer.length >= 4 ? 'var(--text-secondary)' : 'var(--accent-warning)',\r\n                        borderColor: answer.length >= 4 ? 'var(--border-light)' : '#fbbf24'\r\n                      }}\r\n                    >\r\n                      {answer.length}/5000 {answer.length < 4 && `(${4 - answer.length} more needed)`}\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {errors.answer && (\r\n                    <p className=\"text-sm mt-2 font-medium\" style={{ color: 'var(--accent-error)' }}>\r\n                      {errors.answer}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Real-time Quality Warnings (for regular questions only) */}\r\n                {!isAttentionCheck && qualityWarnings.length > 0 && (\r\n                  <div \r\n                    className=\"mb-4 p-3 border rounded-xl\"\r\n                    style={{ \r\n                      background: 'var(--btn-warning-bg)',\r\n                      borderColor: '#fbbf24'\r\n                    }}\r\n                  >\r\n                    <div className=\"flex items-start\">\r\n                      <span style={{ color: 'var(--accent-warning)' }} className=\"mr-2\">‚ö†Ô∏è</span>\r\n                      <div className=\"text-sm\" style={{ color: '#92400e' }}>\r\n                        <p className=\"font-medium mb-1\">Response Quality Notice:</p>\r\n                        <ul className=\"text-xs space-y-1\">\r\n                          {qualityWarnings.map((warning, index) => (\r\n                            <li key={index}>‚Ä¢ {warning}</li>\r\n                          ))}\r\n                        </ul>\r\n                        <p className=\"mt-2 font-medium\">\r\n                          Please provide detailed responses or specify \"none\" if not applicable.\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Success Message */}\r\n                {showSuccess && (\r\n                  <div \r\n                    className=\"mb-4 p-3 border rounded-xl animate-bounce-in\"\r\n                    style={{ \r\n                      background: 'var(--accent-success)',\r\n                      borderColor: 'var(--border-dark)',\r\n                      color: 'var(--text-on-dark)'\r\n                    }}\r\n                  >\r\n                    <div className=\"flex items-center\">\r\n                      <span className=\"mr-2\">‚ú®</span>\r\n                      <span className=\"font-medium text-sm\">Response saved successfully!</span>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Validation Warning */}\r\n                {!isFormValid && (\r\n                  <div \r\n                    className=\"mb-4 p-3 border rounded-xl\"\r\n                    style={{ \r\n                      background: 'var(--btn-warning-bg)',\r\n                      borderColor: '#fbbf24'\r\n                    }}\r\n                  >\r\n                    <div className=\"flex items-start\">\r\n                      <span style={{ color: 'var(--accent-warning)' }} className=\"mr-2\">‚ö†Ô∏è</span>\r\n                      <div className=\"text-sm\" style={{ color: '#92400e' }}>\r\n                        <p className=\"font-medium mb-1\">Please complete the following:</p>\r\n                        <ul className=\"text-xs space-y-1\">\r\n                          <li>‚Ä¢ Add at least 4 characters to your answer or specify \"none\"</li>\r\n                        </ul>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Navigation Buttons */}\r\n                <div \r\n                  className=\"flex justify-between items-center pt-4 border-t\"\r\n                  style={{ borderColor: 'var(--border-light)' }}\r\n                >\r\n                  <button\r\n                    onClick={handlePrevious}\r\n                    disabled={isFirstQuestion || isNavigating}\r\n                    className=\"flex items-center px-4 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\"\r\n                    style={{ \r\n                      background: 'var(--btn-warning-bg)',\r\n                      color: '#92400e'\r\n                    }}\r\n                  >\r\n                    <span className=\"mr-2\">‚Üê</span>\r\n                    Previous\r\n                  </button>\r\n\r\n                  <div className=\"flex space-x-3\">\r\n                    {/* Hide skip for attention checks */}\r\n                    {!isAttentionCheck && (\r\n                      <button\r\n                        onClick={handleSkip}\r\n                        disabled={isNavigating}\r\n                        className=\"px-4 py-2 font-medium rounded-xl transition-all duration-200 text-sm\"\r\n                        style={{ \r\n                          background: 'var(--btn-warning-bg)',\r\n                          color: '#92400e'\r\n                        }}\r\n                      >\r\n                        Skip\r\n                      </button>\r\n                    )}\r\n\r\n                    <button\r\n                      onClick={handleSave}\r\n                      disabled={isSaving || !isFormValid || isNavigating}\r\n                      className=\"px-4 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\"\r\n                      style={{ \r\n                        background: 'var(--btn-secondary-bg)',\r\n                        color: 'var(--text-on-dark)'\r\n                      }}\r\n                    >\r\n                      {isSaving ? 'Saving...' : 'Save'}\r\n                    </button>\r\n\r\n                    <button\r\n                      onClick={handleNext}\r\n                      disabled={isSaving || !isFormValid || isNavigating}\r\n                      className=\"flex items-center px-5 py-2 font-medium rounded-xl transition-all duration-200 disabled:cursor-not-allowed text-sm disabled:opacity-50\"\r\n                      style={{ \r\n                        background: 'var(--btn-primary-bg)',\r\n                        color: 'var(--text-on-dark)'\r\n                      }}\r\n                    >\r\n                      {isNavigating ? 'Moving...' : (\r\n                        <>\r\n                          Save & Continue\r\n                          <span className=\"ml-2\">‚Üí</span>\r\n                        </>\r\n                      )}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Celebration Modal Component (keep icons only, no emojis)\r\nfunction CelebrationModal({ celebration, onClose }: { \r\n  celebration: {type: string, data: any}, \r\n  onClose: () => void \r\n}) {\r\n  const celebrations = {\r\n    topic: {\r\n      icon: 'üéØ',\r\n      title: 'Topic Completed!',\r\n    },\r\n    subcategory: {\r\n      icon: 'üèÜ',\r\n      title: 'Subcategory Mastered!',\r\n    },\r\n    category: {\r\n      icon: 'üëë',\r\n      title: 'Category Champion!',\r\n    }\r\n  };\r\n\r\n  const config = celebrations[celebration.type as keyof typeof celebrations];\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 animate-fade-in p-4\">\r\n      <div \r\n        className=\"rounded-2xl p-6 max-w-lg mx-auto text-center shadow-2xl animate-bounce-in\"\r\n        style={{ \r\n          backgroundColor: 'var(--bg-card)',\r\n          border: '1px solid var(--border-light)'\r\n        }}\r\n      >\r\n        <div className=\"text-5xl mb-3\">{config.icon}</div>\r\n        <h2 \r\n          className=\"text-2xl font-bold mb-3\"\r\n          style={{ color: 'var(--text-primary)' }}\r\n        >\r\n          {config.title}\r\n        </h2>\r\n        <div \r\n          className=\"p-4 rounded-xl mb-4\"\r\n          style={{ \r\n            background: 'linear-gradient(to right, var(--tag-category-bg), var(--tag-subcategory-bg))',\r\n            border: '1px solid var(--border-light)'\r\n          }}\r\n        >\r\n          <p \r\n            className=\"font-medium text-lg mb-2\"\r\n            style={{ color: 'var(--text-primary)' }}\r\n          >\r\n            \"{celebration.data.name}\"\r\n          </p>\r\n          <p \r\n            className=\"text-sm\"\r\n            style={{ color: 'var(--text-secondary)' }}\r\n          >\r\n            {celebration.type === 'topic' && `in ${celebration.data.subcategoryName}`}\r\n            {celebration.type === 'subcategory' && `from ${celebration.data.categoryName}`}\r\n            {celebration.type === 'category' && 'Entire category completed!'}\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={onClose}\r\n          className=\"px-6 py-2 font-medium rounded-xl transition-all duration-200\"\r\n          style={{ \r\n            background: 'var(--btn-primary-bg)',\r\n            color: 'var(--text-on-dark)'\r\n          }}\r\n        >\r\n          Continue Survey\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}